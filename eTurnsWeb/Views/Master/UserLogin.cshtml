@model eTurns.DTO.LoginModel
@using CaptchaMvc.HtmlHelpers
@using CaptchaMvc
@{
    Layout = null;
    ViewBag.Title = "Login";
    if (ViewBag.OktaSSOErrorMessage != null)
    {
        <script>alert('@ViewBag.OktaSSOErrorMessage');</script>
    }
    var modelCommon = new eTurns.DTO.CommonDTO { PageName = "Login" };
    List<UserMasterDTO> lstAllUsers = (List<UserMasterDTO>)ViewBag.AllUsers;
    bool ShowInputs = false;
    string LoginPostMethod = "UserLoginAuthanticate";
    if (ViewBag.LoginWithSelection != "1")
    {
        ShowInputs = true;
    }
    else
    {
        ShowInputs = false;
    }
    ShowInputs = true;
    if (ViewBag.IsMasterDbLogin == "1")
    {
        LoginPostMethod = "UserLoginAuthanticateMasterDataBase";
    }
    string RetURL = string.Empty;
    if (!string.IsNullOrWhiteSpace(Convert.ToString(Request.QueryString["ReturnUrl"])))
    {
        RetURL = Convert.ToString(Request.QueryString["ReturnUrl"]);
    }

    LoginPostMethod = "UserLogin";
    string Status = string.Empty;
    string Message = string.Empty;
    if (!string.IsNullOrWhiteSpace(Convert.ToString(ViewBag.Status)))
    {
        Status = Convert.ToString(ViewBag.Status);
    }
    if (!string.IsNullOrWhiteSpace(Convert.ToString(ViewBag.Message)))
    {
        Message = Convert.ToString(ViewBag.Message);
    }
    string currentDomain = HttpContext.Current.Request.Url.Host.ToLower();

    string amazon_callback_uri = string.Empty, amazon_state = string.Empty, applicationId = string.Empty, showWelcomeAbUser = string.Empty;

    if (Request["amazon_callback_uri"] != null)
    {
        amazon_callback_uri = Request["amazon_callback_uri"];
    }
    if (Request["amazon_state"] != null)
    {
        amazon_state = Request["amazon_state"];
    }
    if (Request["applicationId"] != null)
    {
        applicationId = Request["applicationId"];
    }
    if (Request["ShowWelcomeAbUser"] != null)
    {
        showWelcomeAbUser = Request["ShowWelcomeAbUser"];
    }
    var cssPostfix = "";
    var fontPath = "https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400;500;600;700;800&family=Montserrat:wght@300;400;500;600;700;800;900&family=Open+Sans:wght@300&display=swap";
    if (SiteSettingHelper.IsBorderStateURL == "1" && SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
    {
        fontPath = "/Content/SiteBS.css";
        cssPostfix = SiteSettingHelper.BorderStateDesignCssPostFix;
    }
    var isSpecialUrl = false;
    if (SiteSettingHelper.EnableOktaLoginForSpecialUrls!=null && SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
    {
        isSpecialUrl = true;
    }
}
<!DOCTYPE html>
<link href="@fontPath" rel="stylesheet">
<link href="@Url.Content("~/Content/OpenAccess/LoginNews"+cssPostfix+".css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/OpenAccess/loginstylesNews"+cssPostfix+".css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Content/OpenAccess/jquery-1.7.1.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/OpenAccess/jquery.cookie.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/OpenAccess/sha1-min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/OpenAccess/moment-with-locales.min.js")" type="text/javascript"></script>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Login</title>
    @if (isSpecialUrl)
    {
        <link rel="icon" type="image/x-icon" href="~/Content/images/favicon_BS.ico">
    }
    else
    {
        <link rel="icon" type="image/x-icon" href="~/Content/images/favicon.ico">
    }

    <style type="text/css">
        html {
            display: none;
            visibility: hidden;
        }
    </style>
</head>
<body>
    @if (SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
    {
    <div class="header">
        <a href="https://vmi.borderstates.com/" target="_blank" title="@eTurns.DTO.Resources.ResLayout.LogoTitle">
            <img src="~/Content/OpenAccess/borderstatelogo-white.png" alt="@eTurns.DTO.Resources.ResLayout.LogoImgAlt" style="width:250px;height:80px;" />
        </a>
    </div>
    }

    @using (Html.BeginForm(LoginPostMethod, "Master", FormMethod.Post, new { @id = "frmUserLogin" }))
    {
        @Html.AntiForgeryToken()
        <div class="wrapper">
            <div id="container" class="clearfix">
                <div id="contentWrap" class="clearfix">

                    <div class="mainGreybgHeader">
                        <div class="headerleftlogo logincenter">
                            <h1 id="logo" class="alignLeft">
                                @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                                {
                                    <a href="https://www.eturns.com/" target="_blank" title="@eTurns.DTO.Resources.ResLayout.LogoTitle">
                                        <img src="~/Content/OpenAccess/eturnslogo.jpg" alt="@eTurns.DTO.Resources.ResLayout.LogoImgAlt" style="width:75%;" />
                                    </a>
                                }
                                
                            </h1>
                            <h1 class="simpleoptimisedheader">
                                Automated Replenishment of Stockrooms and Trucks.
                            </h1>
                            <div class="loginContent alignLeft">
                                <div class="login alignLeft">
                                    <div class="loginForm clear">
                                        @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                                        {
                                            <h2 class="alignLeft" style="width:100%; text-align:center;">
                                                Login
                                            </h2>
                                        }
                                        else
                                        {
                                            <h1 class="simpleoptimisedheader">
                                                IF YOU ENCOUNTER ANY ISSUES WHILE LOGGING INTO BORDER STATES VMI, please email <a href="mailto:bsehelpdesk@borderstates.com">bsehelpdesk@borderstates.com</a>
                                            </h1>
                                        }
                                    </div>
                                    <div class="loginForm clear">
                                        @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                                        {
                                            <ul>
                                                <li>
                                                    <div id="ErrorMSG" style="color: Red">
                                                    </div>
                                                </li>
                                            </ul>
                                            <ul>
                                                <li class="alignLeft">
                                                    <span>
                                                        <img alt="username" class="icon" src="@Url.Content("~/Content/OpenAccess/username-icon.png")" />
                                                    </span>
                                                </li>
                                                <li class="alignLeft">
                                                    @Html.TextBoxFor(model => model.Email, new { @id = "txtUserName", @placeholder = "User name", @autocomplete = "off", @class = "inputtext" })

                                                </li>
                                            </ul>
                                            <ul>
                                                <li class="alignLeft">
                                                    <span>
                                                        <img alt="password" class="icon" src="@Url.Content("~/Content/OpenAccess/password.png")" />
                                                    </span>
                                                </li>
                                                <li class="alignLeft">
                                                    @Html.PasswordFor(model => model.Password, new { @id = "txtPassword", @placeholder = "Password", @autocomplete = "off", @class = "inputtext" })

                                                </li>
                                            </ul>
                                        }

                                        <ul style="display: none;">
                                            <li class="alignLeft">
                                                <span>
                                                    <img alt="username" class="icon" src="@Url.Content("~/Content/OpenAccess/password.png")" />
                                                </span>
                                            </li>
                                            <li class="alignLeft">
                                                <div style="float: left;">
                                                    @Html.Captcha(ResLoginForms.RefressCaptchaImage, "Please enter the above generated code in below textbox", 3, "Captcha required", true, null)
                                                </div>
                                            </li>
                                        </ul>
                                        <ul>
                                            <li class="alignLeft">
                                                <span style="margin-right:23px;">
                                                    &nbsp;
                                                </span>
                                            </li>
                                            <li class="alignLeft" style="display:none">

                                                @Html.CheckBoxFor(model => model.IsRemember, new { @id = "chkRemember" })
                                                <label for="chkRemember">
                                                    Remember me
                                                </label>

                                            </li>
                                        </ul>
                                        <ul>
                                            <li class="alignLeft" style="padding-left:30px;">
                                                @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                                                {
                                                    <input type="submit" class="searchBtn" value="Login" id="btnLogin" />
                                                    @Html.HiddenFor(model => model.ReturnUrl, new { @Value = RetURL })
                                                    @Html.HiddenFor(model => model.amazon_callback_uri)
                                                    @Html.HiddenFor(model => model.amazon_state)
                                                    @Html.HiddenFor(model => model.applicationId)
                                                    @Html.HiddenFor(model => model.eTurns_state)
                                                }
                                            </li>
                                            @if (isSpecialUrl)
                                            {
                                                <li class="alignLeft oktabutton">
                                                    <a href="@Url.Action("SignIn", "OktaClient")" style="color:white;padding-top:30px;text-decoration:none;">
                                                        Login to Border States VMI
                                                    </a>
                                                </li>
                                            }
                                            @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                                            {
                                                <li class="alignLeft" style="margin-left:16px;">
                                                    <a href="@Url.Action("ForgotPassword", "Master")">
                                                        Forgot
                                                        Password
                                                    </a>
                                                </li>
                                            }
                                            @*<li>
                                                    <input type="submit" class="searchBtn" value="Login With Okta" id="btnLoginWithOkta" />
                                                </li>*@
                                        </ul>

                                    </div>
                                </div>

                            </div>
                            @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                            {
                                <div class="loginContent alignLeft">
                                    <ul>
                                        @*<li class="alignLeft"><b style="color:black;">Like eTurns?</b> Please spread the word and review us <a href="https://reviews.capterra.com/new/148776" target="_blank">here</a></li>
                                            <li class="alignLeft" style="width:100%; text-align:center;">First 30 people to review eTurns TrackStock <a href="https://www.g2.com/products/eturns/reviews/start" target="_blank">here</a> get a $20 gift card to Amazon</li>
                                                                <li class="alignLeft" style="width:100%; text-align:center;">Review eTurns TrackStock <a href="https://www.g2.com/products/eturns/reviews/start" target="_blank">here</a> and get a $20 gift card to Amazon</li>
                                                                <li class="alignLeft" style="width:100%; text-align:center;">For eTurns tips and advice <a href="https://mailchi.mp/eturns/trackstock-enews" target="_blank">sign up for eTurns e-News</a></li>*@

                                        @*<li class="alignLeft" style="width:100%; text-align:center;">Review eTurns TrackStock <a href="https://www.g2.com/products/eturns/reviews/start" target="_blank">here</a> and get a $25 Amazon gift card.</li>*@
                                        @*<li class="alignLeft" style="width:100%; text-align:center;">(Just email <a href="mailto:support@eturns.com">support@eturns.com</a> with a screenshot of your review).</li>*@
                                        <li class="alignLeft" style="width:100%; text-align:center;">Support questions? Please email <a href="mailto:support@eturns.com">support@eturns.com</a></li>
                                        <li class="alignLeft" style="width:100%; text-align:center;">For eTurns tips and advice <a href="https://mailchi.mp/eturns/trackstock-enews" target="_blank">sign up for eTurns e-News</a></li>

                                    </ul>


                                </div>
                            }
                        </div>
                        @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                        {
                            <div id="headerrightnews" class="headerrightnews">

                                @*@{Html.RenderAction("eTurnsNewsBlogs", "Master");}*@

                            </div>
                        }

                    </div>

                </div>
                @if (!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                {
                    <section class="trackStockPlans">
                        <div class="planLoginSection">
                            <div class="row">
                                <div class="col-md-6 col-lg-3">
                                    <div class="replenish">
                                        <h2 class="repleTitle">TrackStock Replenish</h2>
                                        <p class="billed">
                                            Scan barcodes to reorder. Do cycle counts with min/max replenishment. Do VMI/CMI.
                                        </p>
                                        <h4 class="includesTitle">Includes</h4>
                                        <ul>
                                            <li>Unlimited users, suppliers</li>
                                            <li>Alerts dashboard analytics</li>
                                            <li>Barcode label designer</li>
                                            <li>Consigned inventory</li>
                                            <li>Cycle count</li>
                                            <li>Integration</li>
                                            <li>Set min/max levels</li>
                                            <li>Reporting: View 85 reports</li>
                                            <li>User permissions</li>
                                            <li>Audit trail</li>
                                            <li>Certification: SOC II Type 2</li>
                                            <li>17 languages</li>
                                        </ul>
                                        @*<a id="ancReplenish" class="btn Replenishbtn mb-3">Get Replenish Trial</a>*@
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3">
                                    <div class="replenish">
                                        <h2 class="repleTitle">TrackStock Manage Lite</h2>
                                        <p class="billed">
                                            Track usage and auto-replenish. Get usage reports. Option to use SensorBins and eLabels.
                                        </p>
                                        <h4 class="includesTitle"> Includes everything in Replenish, plus:</h4>
                                        <ul>
                                            <li class="active">Pulls</li>
                                            <li>Receives</li>
                                            <li>Track expiration dates, lot numbers, serial numbers</li>
                                            <li>Reporting: schedule reports with email alert</li>
                                        </ul>
                                        <p class="bottomTitle">**SensorBins, eLabels, RFID available.</p>
                                        @*<a id="ancManageLite" class="btn Replenishbtn mb-3">Get Manage Lite Trial</a>*@
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3">
                                    <div class="replenish">
                                        <h2 class="repleTitle">TrackStock Manage</h2>
                                        <p class="billed">
                                            Get analytics. Use advanced features. Customize reports.
                                        </p>
                                        <h4 class="includesTitle">Includes everything in Manage Lite, plus:</h4>
                                        <ul>
                                            <li class="active">Work orders</li>
                                            <li>User-defined fields</li>
                                            <li>Reporting: Customizable reports</li>
                                            <li>Transfers</li>
                                            <li>Returns</li>
                                            <li>Project spend limits</li>
                                            <li>Stage material</li>
                                        </ul>
                                        <p class="bottomTitle">**SensorBins, eLabels, RFID available.</p>
                                        @*<a id="ancManage" class="btn Replenishbtn mb-3">Get Manage Trial</a>*@
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3">
                                    <div class="replenish">
                                        <h2 class="repleTitle">TrackStock Optimize</h2>
                                        <p class="billed">Optimize inventory with AI. Track tools, assets, requisitions, kitting.</p>
                                        <h4 class="includesTitle">Includes everything in Manage, plus:</h4>
                                        <ul>
                                            <li class="active">AI Min/Max dashboard analytics</li>
                                            <li>Quotes/punchout</li>
                                            <li>Tool tracking</li>
                                            <li>Asset maintenance</li>
                                            <li>Kitting</li>
                                            <li>Requisitions</li>
                                            <li>Reporting: Create catalog reports</li>
                                        </ul>
                                        <p class="bottomTitle">**SensorBins, eLabels, RFID available.</p>
                                        @*<a id="ancOptimize" class="btn Replenishbtn mb-3">Get Optimize Trial</a>*@
                                    </div>
                                </div>


                            </div>
                        </div>
                    </section>
                }

                @*<div id="contentWrap" class="clearfix">

                        <div class="content">

                            <div class="mainGreybg" style="min-height: 234px;">
                                <div class="loginBg" style="min-height: 230px;">
                                    <div class="imgContent alignLeft">
                                        <section>
                                            <div id="technology-chart" class="container main-section">
                                                <div class="row">
                                                    <div class="col-12">
                                                        <h1 class="text-center text-eturns-red">eTurns TrackStock offers levels of automated replenishment</h1>
                                                    </div>
                                                </div>
                                                <div class="row py-4">
                                                    <div class="col-lg-3 d-none d-lg-block">
                                                        <h3 class="text-center text-eturns-green border-bottom-green">TrackStock<br />Replenish</h3>

                                                    </div>
                                                    <div class="col-lg-3 d-none d-lg-block">
                                                        <h3 class="text-center text-eturns-purple border-bottom-purple">TrackStock<br />Manage</h3>
                                                    </div>
                                                    <div class="col-lg-6 d-none d-lg-block">
                                                        <h3 class="text-center text-eturns-blue border-bottom-blue">TrackStock<br />Optimize</h3>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-lg-3 d-flex align-self-stretch">
                                                        <div class="card border-0">
                                                            <div class="card-body text-center">
                                                                <p class="text-center"><a target="_blank" href="https://www.eturns.com/solutions/vendorcustomer-managed-inventory"> <img src="@Url.Content("~/Content/OpenAccess/technology-replenish.png")" class="img-fluid"></a></p>
                                                                <p style="text-align: center;"><strong><em>Scan barcodes to reorder or count</em></strong></p>
                                                            </div>
                                                            <div class="card-footer text-center bg-white">
                                                                Mobile App (IOS, Android)
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-3 d-flex align-self-stretch">
                                                        <div class="card border-0">
                                                            <div class="card-body text-center">
                                                                <p class="text-center"><a target="_blank" href="https://www.eturns.com/solutions/automated-replenishment"> <img src="@Url.Content("~/Content/OpenAccess/technology-manage.png")" class="img-fluid"></a></p>
                                                                <p style="text-align: center;"><strong><em>Track usage. know quantity on hand. Manage consigned inventory.</em></strong></p>
                                                            </div>
                                                            <div class="card-footer text-center bg-white">
                                                                Mobile App
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-lg-6 d-flex align-self-stretch">
                                                        <div class="card border-0">
                                                            <div class="card-body text-center">
                                                                <p class="text-center"><a target="_blank" href="https://www.eturns.com/solutions/rfid-inventory-management"><img src="@Url.Content("~/Content/OpenAccess/technology-rfid-new.jpg")" class="img-fluid"></a></p>
                                                                <p style="text-align: center;"><strong><em>Optimize point-of-use inventories using analytics. Manage tool cribs, kitting, spend limits, requisitions, asset maintenance </em></strong></p>
                                                            </div>
                                                            <div class="card-footer text-center bg-white">
                                                                Mobile App, RFID, SensorBins
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </section>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>*@

            </div>

            <div id="footer" class="clearfix">
                <div class="copyright">
                    @if(!SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
                    {
                        <span>&copy; Copyright © @eTurns.DAL.DateTimeUtility.DateTimeNow.Year.ToString() eTurns.com.
                         All rights reserved.</span>
                    }
                    </div>
            </div>
            <!-- footer ends -->
            <div id="overlay" style="display:none;"></div>
            <div class="welcomeMessage" style="display:none;">
                <span class="closeBtn"><img src="/Content/OpenAccess/close_btn.png" /></span>
                @*<div class="welMsg">Welcome!</div>*@
                Welcome to TrackStock! In less than a minute you will be getting an email with your username and password credentials for signing in here to TrackStock. Once you're signed in, remember to go to the Help " <img src="~/Content/images/faq-question-icon.png" alt="Help Documents" /> circle" menu for the QuickStart Guide and Videos.
            </div>
        </div>

    }
    @if (SiteSettingHelper.EnableOktaLoginForSpecialUrls.Contains(eTurnsWeb.Helper.SessionHelper.CurrentDomainURL))
    {
<div class="footer">
    Copyright © @eTurns.DAL.DateTimeUtility.DateTimeNow.Year.ToString() Border states
</div>
    }
    <script type="text/javascript">
        var currentDomain = '@currentDomain';
        var ShowWelcomeAbUser = '@showWelcomeAbUser';
        $(document).ready(function () {

            if (window.location.href.indexOf("staging") < 0 && window.location.href.indexOf("amazonaws") < 0 && window.location.href.indexOf("14.") < 0 && window.location.href.indexOf("54.88.163") < 0 && window.location.href.indexOf("192.") < 0 && window.location.href.indexOf("localhost") < 0 && window.location.href.indexOf("demo") < 0 && window.location.protocol != 'https:') {
                location.href = location.href.replace("http://", "https://");
            }
            if (self == top) {
                document.documentElement.style.display = 'block';
                document.documentElement.style.visibility = 'visible';
            }
            else {
                top.location = self.location;
            }
            if ('@Status' == "fail") {
                $("#ErrorMSG").html('@Message');
                setTimeout(function () {
                    window.location.href = window.location.href;
                }, 1000);
            }

            var sdfsdf = document.all;
            $.fn.serializeObject = function () {
                var o = {};
                var a = this.serializeArray({ checkboxesAsBools: true });
                $.each(a, function () {
                    if (o[this.name]) {
                        if (!o[this.name].push) {
                            o[this.name] = [o[this.name]];
                        }
                        o[this.name].push(this.value || '');
                    } else {
                        o[this.name] = this.value || '';
                    }
                });

                return o;
            };

            $.fn.serializeArray = function (options) {
                var o = $.extend({
                    checkboxesAsBools: false
                }, options || {});

                var rselectTextarea = /select|textarea/i;
                var rinput = /text|hidden|password|search/i;

                return this.map(function () {
                    return this.elements ? $.makeArray(this.elements) : this;
                })
                .filter(function () {
                    return this.name && !this.disabled &&
                        (this.checked
                        || (o.checkboxesAsBools && this.type === 'checkbox')
                        || rselectTextarea.test(this.nodeName)
                        || rinput.test(this.type));
                })
                    .map(function (i, elem) {
                        var val = $(this).val();
                        return val == null ?
                        null :
                        $.isArray(val) ?
                        $.map(val, function (val, i) {
                            return { name: elem.name, value: val };
                        }) :
            {
                name: elem.name,
                value: (o.checkboxesAsBools && this.type === 'checkbox') ? //moar ternaries!
                    (this.checked ? 'true' : 'false') :
                    val
            };
                    }).get();
            };


            if ('@ShowInputs' == '@Boolean.TrueString') {
                $("#txtUserName").focus();
            }
            else {
                $("#Email").focus();
            }
            /*START - REMOVE COOKIE */
            document.cookie = "eturnsUserName=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict;";
            document.cookie = "eturnsPassword=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict;";
            /*END - REMOVE COOKIE */

            /*START - SET COOKIE */
            //var UserName = getCookie('eturnsUserName');
            //var Password = getCookie('eturnsPassword');

            //if (!$.cookie('eturnsUserName')) {

            //}
            //if (UserName != '' && Password != '') {
            //if (UserName != '') {
            //    $("#txtUserName").val(UserName);
            //}
            //if (Password != '') {
            //    $("#txtPassword").val(Password);
            //}
            var rememberMe = getCookie('RememberMe');

            if (rememberMe !== undefined && rememberMe != null && rememberMe == "true") {
                $('#chkRemember').attr('checked', 'checked');
            }

            /*END - SET COOKIE */

            /* Start Render news Portion  */
            $.ajax({
                "url": '@Url.Action("eTurnsNewsBlogs", "Master")',
                "type": 'GET',
                "async": false,
                "cache": false,
                "dataType": "html",
                "success": function (response) {
                    $("#headerrightnews").html(response);
                },
                "error": function (err) {
                }
            });
            /* End Render news Portion  */

            if (ShowWelcomeAbUser != null && typeof (ShowWelcomeAbUser) != "undefined" && ShowWelcomeAbUser.length > 0 && ShowWelcomeAbUser.toLowerCase() == "yes")
            {
                $("#overlay, .welcomeMessage").show();
            }

            $(".closeBtn").click(function () {
                $("#overlay, .welcomeMessage").hide();
            });
        });
        $("form").submit(function (e) {
            $.cookie('lastajaxcallstarttime', moment.utc().format("YYYY-MM-DD HH:mm:ss Z"), { path: '/', SameSite: 'Strict'  });
            if ($('#chkRemember').prop("checked")) {
                $.cookie('RememberMe', true, { SameSite: 'Strict' });
                //$.cookie('eturnsUserName', $("#txtUserName").val());
                //if (currentDomain != "arrowcares.arrow.com") {
                //    $.cookie('eturnsPassword', $("#txtPassword").val());
                //}
                //else {
                //    $.cookie('eturnsPassword', '');
                //}
            }
            else {
                $.cookie('RememberMe', false, { SameSite: 'Strict' });
                //$.cookie('eturnsUserName', '');
                //$.cookie('eturnsPassword', '');
            }

            if ('@ShowInputs' == '@Boolean.TrueString') {
                //alert(hex_sha1($("#txtPassword").val()));
                if ($.trim($("#txtPassword").val()) !== '') {
                    $("#txtPassword").val(hex_sha1($("#txtPassword").val()));
                }
            }
            if (RedirectToAnother() == true) {
                return true;
            }
            else {
                return false;
            }
        });

        $("#Email").change(function () {
            $("#txtUserName").val($(this).find("option:selected").text());
            $("#txtPassword").val($(this).val());
            $("#frmUserLogin").submit();
        });

        function OnBegin() {

        }

        function CancelClick() {
            $("#ErrorMSG").html("");
            return false;
        }

        function RedirectToAnother() {
            var UserBlank = false;
            var PassBlank = false;
            var msg = "";
            var userName = $.trim($("#txtUserName").val());
            var password = $.trim($("#txtPassword").val());

            if (userName == '' || userName.toLowerCase() == 'email') {
                UserBlank = true;
            }
            if (password == '' || password.toLowerCase() == 'password') {
                PassBlank = true;
            }
            if (UserBlank == true && PassBlank == true) {
                msg = "Username and password is mandatory";
            }
            else if (UserBlank == true) {
                msg = "Username is mandatory";
            }
            else if (PassBlank == true) {
                msg = "Password is mandatory";
            }
            if (msg != "") {
                $("#ErrorMSG").html(msg);
                return false;
            }
            else {
                return true;
                //var form = $("#frmUserLogin").serializeArray({ checkboxesAsBools: true });
                //                var headers = {};
                //                var token = $('[name="__RequestVerificationToken"]').val();
                //                headers["__RequestVerificationToken"] = token;

                @*$.ajax({
                    type: "POST",
                    url: "/Master/" + '@LoginPostMethod',
                    //                    data: "{'Email': '" + $("#txtUserName").val() + "' ,'Password':'" + $("#txtPassword").val() + "','IsRemember':" + $('#chkRemember').is(':checked') + ",'__RequestVerificationToken' : '" + encodeURIComponent($('[name="__RequestVerificationToken"]').val()) + "'}",
                    data: form,
                    //                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    //                    headers: headers,
                    cache: false,
                    success: function (message) {

                        if (message.Message.toLowerCase() == "fail") {
                            msg = "UserName or Password is invalid";
                            $("#ErrorMSG").html(msg);
                            return false;
                        }
                        else {

                            if (message.HasLicenceAccepted) {
                                $.ajax({
                                    type: "POST",
                                    url: "/Master/CheckPasswordChange",
                                    data: "",
                                    contentType: "application/json; charset=utf-8",
                                    dataType: "json",
                                    success: function (message) {
                                        if (message.Message == "ok") {
                                            window.location = '/Master/ChangePassword';
                                        }
                                        else {
                                            //window.location = '/Master/InventoryAnalysis';
                                            //window.location = '/Master/Dashboard';
                                            //window.location = '/Inventory/ItemMasterList';
                                            window.location = '/Master/RedirectToPage';
                                        }

                                    },
                                    error: function (response) {
                                        // through errror message
                                    }
                                });



                            }
                            else {

                                window.location = '/Master/TermsAndCondition';
                                //window.location = '/Master/_LicencingTermsandConditions';

                            }




                            // window.location = '/Replenish/CartItemList';
                        }
                    },
                    error: function (response) {
                        // through errror message
                    }
                });*@

            }
        }

        function getCookie(name) {
            var arg = name + "=";
            var alen = arg.length;
            var clen = document.cookie.length;
            var i = 0;
            while (i < clen) {
                var j = i + alen;
                if (document.cookie.substring(i, j) == arg) {
                    return getCookieVal(j);
                }
                i = document.cookie.indexOf(" ", i) + 1;
                if (i == 0) break;
            }
            return null;
        }

        function getCookieVal(offset) {
            var endstr = document.cookie.indexOf(";", offset);
            if (endstr == -1) { endstr = document.cookie.length; }
            return unescape(document.cookie.substring(offset, endstr));
        }

        function setCookie(name, value, days) {
            if (typeof days != "undefined") { //if set persistent cookie
                var expireDate = new Date();
                expireDate.setDate(expireDate.getDate() + days);
                document.cookie = name + "=" + value + "; path=/; expires=" + expireDate.toGMTString() + " ;SameSite=Strict;";
            }
            else //else if this is a session only cookie
                document.cookie = name + "=" + value + "; path=/ ;SameSite=Strict;";
        }
        $('#btnForgotPassword').click(function (e) {
            location.href = '@Url.Action("ForgotPassword", "Master")';
        });
        $('#btnForgotPassword').click(function (e) {
            location.href = '@Url.Action("ForgotPassword", "Master")';
        });
    </script>
</body>
</html>
