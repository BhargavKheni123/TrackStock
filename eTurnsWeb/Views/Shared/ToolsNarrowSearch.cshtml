@model CommonDTO
@{
    Model.PageName = "ToolMaster";
    Model.IDsufix = "_Tool";
    //System.Xml.Linq.XElement Settinfile = System.Xml.Linq.XElement.Load(System.Web.Hosting.HostingEnvironment.MapPath("/SiteSettings.xml"));
    //string LoadDataCount = Settinfile.Element("LoadNarrowDataCount") != null ? Convert.ToString(Settinfile.Element("LoadNarrowDataCount").Value) : "0";
    string LoadDataCount = eTurns.DTO.SiteSettingHelper.LoadNarrowDataCount != string.Empty ? Convert.ToString(eTurns.DTO.SiteSettingHelper.LoadNarrowDataCount) : "0";
    
}
<script type='text/javascript' src="@Url.Content("~/Scripts/date.js")"></script>
<div class="leftopenContent" style="display: none;">
    <a class="openBtn" id="ExpandNarrowSearch">
        <img src="~/Content/images/open.png" />
    </a>
</div>
<div class="IteamBlock">
    <a class="closedBtn" id="CollapseNarrowSearch">
        <img src="~/Content/images/closed.png" />
    </a>
    <h2>@eTurns.DTO.Resources.ResNarrowSearch.NarrowSearchHeader2</h2>
    <ul id="NarrowUL">
        <li>
            <select id="ToolsCategory" class="showloadmore" data-unique="reqtoolscategory" multiple="multiple" name="example-basic" size="5"></select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolsCategoryCollapse">
                </div>
            </div>
        </li>
        <li>
            <div class="stockroom">
                <div class="editor-field">
                    @eTurns.DTO.ResToolMaster.Cost:
                    <select id="ToolsCost" class="selectBox" onchange="CostNarroSearch(this);">
                        <option value="0_-1"></option>
                        <option value="1000_1000">>$1000 </option>
                        <option value="750_999">>$750 to 999 </option>
                        <option value="500_749">>$500 to 749 </option>
                        <option value="250_499">>$250 to 499 </option>
                        <option value="0_249">$0 to 249 </option>
                    </select>
                </div>
            </div>
        </li>
        <li>
            <select id="ToolCheckout" multiple="multiple" name="example-basic" size="5">
                <option value="1">Checked out</option>
                <option value="2">Checked out to Maintenance</option>
                <option value="3">Group fully checked out</option>
                <option value="4">None checked out</option>
            </select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolCheckoutCollapse">
                </div>
            </div>

        </li>
        <li>
            <select id="ToolsTechnician" multiple="multiple" name="example-basic" size="5"></select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolsTechnicianCollapse">
                </div>
            </div>
        </li>
        <li>
            <select id="ToolsLocation" class="showloadmore" data-unique="reqtoolslocation" multiple="multiple" name="example-basic" size="5"></select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolsLocationCollapse">
                </div>
            </div>
        </li>
        <li>
            <select id="ToolUserCreated" multiple="multiple" name="example-basic" size="5"></select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolUserCreatedCollapse">
                </div>
            </div>
        </li>
        <li>
            <select id="ToolUserUpdated" multiple="multiple" name="example-basic" size="5"></select>
            <div class="accordion" id="accordion">
                <a href='#' class='downarrow'>
                    <img src="~/Content/images/down-arrow.gif" alt="" height="24">
                </a>
                <div class='dropcontent' id="ToolUserUpdatedCollapse">
                </div>
            </div>
        </li>
        <li style="float: left;">
            <div class="dateForm">
                <span class="dateText">@eTurns.DTO.Resources.ResNarrowSearch.DateCreated</span>
                <div style="float: right; margin-top: -24px; cursor: pointer;">
                    <img id="ToolDateCreatedClear" src="~/Content/images/XClear.png" alt="@ResNarrowSearch.Clear" />
                </div>
                <div class="divLabel" style="padding-bottom: 4px;">
                    <label for="From" class="labelText">
                        @eTurns.DTO.Resources.ResNarrowSearch.From
                    </label>
                    <input id="ToolDateCFrom" type="text" value="" name="From" data-val-length-max="20" data-val="true"
                           class="text-box" />
                    <a href="javascript:;" title="" class="datePicker" id="ancToolDateCFrom">
                        <img src="~/Content/images/date-picker-icon.png" alt="" title="" />
                    </a>
                </div>
                <div class="divLabel">
                    <label for="To" class="labelText">
                        @eTurns.DTO.Resources.ResNarrowSearch.To
                    </label>
                    <input id="ToolDateCTo" type="text" value="" name="To" data-val-length-max="20" data-val="true"
                           class="text-box" />
                    <a href="javascript:;" title="" class="datePicker" id="ancToolDateCTo">
                        <img src="~/Content/images/date-picker-icon.png" alt="" title="" />
                    </a>
                </div>
            </div>
        </li>
        <li style="float: left;">
            <div class="dateForm">
                <span class="dateText">@eTurns.DTO.Resources.ResNarrowSearch.DateUpdated</span>
                <div style="float: right; margin-top: -24px; cursor: pointer;">
                    <img id="ToolDateUpdatedClear" src="~/Content/images/XClear.png" alt="@ResNarrowSearch.Clear" />
                </div>
                <div class="divLabel" style="padding-bottom: 4px;">
                    <label for="From" class="labelText">
                        @eTurns.DTO.Resources.ResNarrowSearch.From
                    </label>
                    <input id="ToolDateUFrom" type="text" value="" name="From" data-val-length-max="20" data-val="true"
                           class="text-box" />
                    <a href="javascript:;" title="" class="datePicker" id="ancToolDateUFrom">
                        <img src="~/Content/images/date-picker-icon.png" alt="" title="" />
                    </a>
                </div>
                <div class="divLabel">
                    <label for="To" class="labelText">
                        @eTurns.DTO.Resources.ResNarrowSearch.To
                    </label>
                    <input id="ToolDateUTo" type="text" value="" name="To" data-val-length-max="20" data-val="true"
                           class="text-box" />
                    <a href="javascript:;" title="" class="datePicker" id="ancToolDateUTo">
                        <img src="~/Content/images/date-picker-icon.png" alt="" title="" />
                    </a>
                </div>
            </div>
        </li>
        @Html.RenderUDFForNarrowSearch(Model.PageName)
        @Html.RenderUDFForNarrowSearchForItemModel("ToolCheckInOutHistory", Model.IDsufix,"")
    </ul>
    <input id="ToolNarroSearchClear" type="button" value="@ResNarrowSearch.Clear" class="ClearBtn" />
</div>
<script type="text/javascript">
    //NARROW BY SEARCH
    var ICLNarroValues = "";
    var UserCreatedBy = '@eTurns.DTO.Resources.ResNarrowSearch.UserCreatedby';
    var UserUpdatedby = '@eTurns.DTO.Resources.ResNarrowSearch.UserUpdatedby';
    var UpdatedBy = '@eTurns.DTO.Resources.ResNarrowSearch.Updatedby';
    var CreatedBy = '@eTurns.DTO.Resources.ResNarrowSearch.Createdby';
    var selected = '@eTurns.DTO.Resources.ResNarrowSearch.selected';
    var ToolsMaintenance = '@eTurns.DTO.Resources.ResNarrowSearch.ToolsMaintenance';
    var TechnicianList = '@eTurns.DTO.Resources.ResNarrowSearch.Technician';
    var ToolsCategory = '@eTurns.DTO.Resources.ResNarrowSearch.ToolsCategory';
    var ToolsLocation = '@eTurns.DTO.Resources.ResNarrowSearch.ToolsLocation';
    var loadNarrowSearchDataCount = '@LoadDataCount';
    var PageName = '@Model.PageName';

    $(document).ready(function () {
        CallToolNarrowfunctions();
        GetToolsModelNarrowSearchData(false, false, PageName);

        $('a.downarrow').click(function (e) {
            e.preventDefault();
            $(this).closest('.accordion').find('.dropcontent').slideToggle();
        });

        $('#ExpandNarrowSearch').click(function (e) {
            ExpandNarrowSearch();
        });
        $('#CollapseNarrowSearch').click(function (e) {
            CollapseNarrowSearch();
        });

        var NarrowSearchState = getCookie('NarrowSearchState');
        if (NarrowSearchState == 'Expanded') {
            CollapseNarrowSearch();
        }
        else {
            ExpandNarrowSearch();
        }



        $('#ToolDateCFrom').blur(function () {
        }).datepicker({
            dateFormat: RoomDateJSFormat, changeMonth: true,
            changeYear: true, date: true
        });
        $('#ToolDateCTo').blur(function () {
        }).datepicker({
            dateFormat: RoomDateJSFormat, changeMonth: true,
            changeYear: true, date: true
        });
        $('#ToolDateUFrom').blur(function () {
        }).datepicker({
            dateFormat: RoomDateJSFormat, changeMonth: true,
            changeYear: true, date: true
        });
        $('#ToolDateUTo').blur(function () {
        }).datepicker({
            dateFormat: RoomDateJSFormat, changeMonth: true,
            changeYear: true, date: true
        });

        $('#ancToolDateCFrom').click(function () {
            $('#ToolDateCFrom').focus();
        });
        $('#ancToolDateCTo').click(function () {
            $('#ToolDateCTo').focus();
        });
        $('#ancToolDateUFrom').click(function () {
            $('#ToolDateUFrom').focus();
        });
        $('#ancToolDateUTo').click(function () {
            $('#ToolDateUTo').focus();
        });
        
        //CLEAR NARROW SEARCH
        $('#ToolNarroSearchClear').off('click').on('click', function () {

            isFromNarrowSearchClear = true;
            _NarrowSearchSave.objSearch.reset();

            //ToolsCategory
            if (typeof ($("#ToolsCategory").multiselect("getChecked").length) != undefined && $("#ToolsCategory").multiselect("getChecked").length > 0) {
                $("#ToolsCategory").multiselect("uncheckAll");
                $("#ToolsCategoryCollapse").html('');
            }

            //ToolsCost
            if ($('#ToolsCost') != undefined) {
                $('#ToolsCost').val('0_-1');
                ToolCostValue = '';
            }

            //ToolsLocation
            if (typeof ($("#ToolCheckout").multiselect("getChecked").length) != undefined && $("#ToolCheckout").multiselect("getChecked").length > 0) {
                $("#ToolCheckout").multiselect("uncheckAll");
                $("#ToolCheckoutCollapse").html('');
            }

            //ToolsTechnician
            if (typeof ($("#ToolsTechnician").multiselect("getChecked").length) != undefined && $("#ToolsTechnician").multiselect("getChecked").length > 0) {
                $("#ToolsTechnician").multiselect("uncheckAll");
                $("#ToolsTechnicianCollapse").html('');
                ToolTechnicianValue = '';
            }

            //ToolsLocation
            if (typeof ($("#ToolsLocation").multiselect("getChecked").length) != undefined && $("#ToolsLocation").multiselect("getChecked").length > 0) {
                $("#ToolsLocation").multiselect("uncheckAll");
                $("#ToolsLocationCollapse").html('');
            }

            //ToolUserCreated
            if (typeof ($("#ToolUserCreated").multiselect("getChecked").length) != undefined && $("#ToolUserCreated").multiselect("getChecked").length > 0) {
                $("#ToolUserCreated").multiselect("uncheckAll");
                $("#ToolUserCreatedCollapse").html('');
            }

            //ToolUserUpdated
            if (typeof ($("#ToolUserUpdated").multiselect("getChecked").length) != undefined && $("#ToolUserUpdated").multiselect("getChecked").length > 0) {
                $("#ToolUserUpdated").multiselect("uncheckAll");
                $("#ToolUserUpdatedCollapse").html('');
            }

            if ($('#ToolDateCFrom').val() != '') $('#ToolDateCFrom').val('');
            if ($('#ToolDateCTo').val() != '') $('#ToolDateCTo').val('');
            if ($('#ToolDateUFrom').val() != '') $('#ToolDateUFrom').val('');
            if ($('#ToolDateUTo').val() != '') $('#ToolDateUTo').val('');
               
            $("select[name='udflist']").each(function (index) {
                if (typeof ($(this).multiselect("getChecked").length) != undefined && $(this).multiselect("getChecked").length > 0) {
                    var UDFUniqueID = this.getAttribute('UID');
                    $(this).multiselect("uncheckAll");
                    $('#' + UDFUniqueID + 'Collapse').html('');
                    $('#' + UDFUniqueID + 'Collapse').hide();
                }
                else if ((typeof (this.getAttribute('UID'))) != undefined) {
                    var UDFUniqueID = this.getAttribute('UID');
                    $('#' + UDFUniqueID + 'Collapse').html('');
                    $('#' + UDFUniqueID + 'Collapse').hide();
                }
            });

            $("select[name='udflist_Tool']").each(function (index) {
                if (typeof ($(this).multiselect("getChecked").length) != undefined && $(this).multiselect("getChecked").length > 0) {
                    var UDFUniqueID = this.getAttribute('UID');
                    $(this).multiselect("uncheckAll");
                    $('#' + UDFUniqueID + 'Collapse_Tool').html('');
                }
            });
            $('#myDataTable tbody tr').removeClass('row_selected');
            ShowHideChangeLog();
            isFromNarrowSearchClear = false;
            if ($('#ToolModel_filter').val() != '') $('#ToolModel_filter').val('');            
            $('#tblToolsInModel').dataTable().fnFilter('', null, null, null)

        });
    });

    $('#ToolDateCreatedClear').click(function () {
        if ($('#ToolDateCFrom').val() != '' || $('#ToolDateCTo').val() != '') {
            $('#ToolDateCFrom').val('');
            $('#ToolDateCTo').val('');
            //NarrowSearchInGrid('');
            DoNarrowSearchTool();
        }
    });
    $('#ToolDateUpdatedClear').click(function () {
        if ($('#ToolDateUFrom').val() != '' || $('#ToolDateUTo').val() != '') {
            $('#ToolDateUFrom').val('');
            $('#ToolDateUTo').val('');
            //NarrowSearchInGrid('');
            DoNarrowSearchTool();
        }
    });


    $('#ToolDateCFrom,#ToolDateCTo').on('change', function () {

        var format = '@eTurnsWeb.Helper.SessionHelper.RoomDateJSFormat';
        if ($("#hdDateFormat") != undefined && $("#hdDateFormat").val() != "")
            format = $("#hdDateFormat").val();
        else
            format = "m/d/yy";

        var DateCToValid = Date.isValid($('#ToolDateCTo').val(), RoomDateJSFormat); //isDate($('#DateCTo').val());
        var DateCFromValid = Date.isValid($('#ToolDateCFrom').val(), RoomDateJSFormat);

        try {
            $.datepicker.parseDate(RoomDateJSFormat, $('#ToolDateCTo').val());
            DateCToValid = true;
        } catch (e) {
            DateCToValid = false;
        }

        try {
            $.datepicker.parseDate(RoomDateJSFormat, $('#ToolDateCFrom').val());
            DateCFromValid = true;
        } catch (e) {
            DateCFromValid = false;
        }


        if (DateCFromValid && DateCToValid) {
            //$("#global_filter").val('');
            DoNarrowSearchTool();
        }
        else {
            if (!DateCFromValid)
                $('#ToolDateCFrom').val('');
            if (!DateCToValid)
                $('#ToolDateCTo').val('');
        }
    });

    $('#ToolDateUFrom,#ToolDateUTo').on('change',function () {
      
        var format = '';
        if ($("#hdDateFormat") != undefined && $("#hdDateFormat").val() != "")
            format = $("#hdDateFormat").val();
        else
            format = "m/d/yy";

        if (format.indexOf("yy") >= 0) {
            format = format.replace("yy", "yyyy");
        }
        else if (format.indexOf("y") >= 0) {
            format = format.replace("y", "yy");
        }

        var DateUFromValid = Date.isValid($('#ToolDateUFrom').val(), RoomDateJSFormat);
        var DateUToValid = Date.isValid($('#ToolDateUTo').val(), RoomDateJSFormat);

        try {
            $.datepicker.parseDate(RoomDateJSFormat, $('#ToolDateUFrom').val());
            DateUFromValid = true;
        } catch (e) {
            DateUFromValid = false;
        }

        try {
            $.datepicker.parseDate(RoomDateJSFormat, $('#ToolDateUTo').val());
            DateUToValid = true;
        } catch (e) {
            DateUToValid = false;
        }

        if (DateUFromValid && DateUToValid) {
            // $("#global_filter").val('');
            DoNarrowSearchTool();
        }
        else {
            if (!DateUFromValid)
                $('#ToolDateUFrom').val('');
            if (!DateUToValid)
                $('#ToolDateUTo').val('');

        }
    });
    function CallToolNarrowfunctions() {
        GetNarrowDDDataTool('@Model.PageName', '@eTurnsWeb.Helper.SessionHelper.CompanyID', '@eTurnsWeb.Helper.SessionHelper.RoomID', false, false);
        GetNarroHTMLForUDFTool('@Model.PageName', '@eTurnsWeb.Helper.SessionHelper.CompanyID', '@eTurnsWeb.Helper.SessionHelper.RoomID', false, false, 'ToolList', '@Model.IDsufix');
    }



    function GetToolsModelNarrowSearchData(_IsArchived, _IsDeleted,pagename) {
        $.ajax({
            'url': '/Master/GetNarrowDDData',
            data: { TableName: 'ToolMaster', TextFieldName: 'ToolCategory', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
            success: function (response) {
                var s = '';
                $.each(response.DDData, function (ValData, ValCount) {
                    var ArrData = ValData.toString().split('[###]');
                    s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                });
                //Destroy widgets before reapplying the filter
                $("#ToolsCategory").empty();
                $("#ToolsCategory").multiselect('destroy');
                $("#ToolsCategory").multiselectfilter('destroy');

                $("#ToolsCategory").append(s);

                var currentDataCount = $('select#ToolsCategory option').length;
                if (parseInt(currentDataCount) < parseInt(loadNarrowSearchDataCount)) {
                    $(".allreqtoolscategory").hide();
                    $(".morereqtoolscategory").hide();
                }
                var narrowsearchtext = "Tool Category";
                if (typeof ToolsCategory != 'undefined') {
                    narrowsearchtext = ToolsCategory;
                }
                $("#ToolsCategory").multiselect(
                    {
                        noneSelectedText: narrowsearchtext, selectedList: 5,
                        selectedText: function (numChecked, numTotal, checkedItems) {
                            return narrowsearchtext + ': ' + numChecked + ' ' + selected;
                        }
                    },
                    {
                        checkAll: function (ui) {
                            $("#ToolsCategoryCollapse").html('');
                            for (var i = 0; i <= ui.target.length - 1; i++) {
                                if ($("#ToolsCategoryCollapse").text().indexOf(ui.target[i].text) == -1) {
                                    $("#ToolsCategoryCollapse").append("<span>" + ui.target[i].text + "</span>");
                                }
                            }
                            $("#ToolsCategoryCollapse").show();
                        }
                    }
                ).unbind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall")
                    .bind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall", function (event, ui) {
                        if (event.type == 'multiselectloadmore' || event.type == 'multiselectloadall') {
                            var currentDataCount = $('select#ToolsCategory option').length;
                            var _selectedSP = $.map($(this).multiselect("getChecked"), function (input) {
                                return input.value;
                            });

                            var _loaddataCount = parseInt(currentDataCount) + parseInt(loadNarrowSearchDataCount);
                            
                            if (event.type == 'multiselectloadall') {
                                _loaddataCount = -1;
                                $(".allreqtoolscategory").hide();
                                $(".morereqtoolscategory").hide();
                            }
                            $.ajax({
                                'url': '/Master/GetNarrowDDData',
                                data: { TableName: 'ToolMaster', TextFieldName: 'ToolCategory', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList', LoadDataCount: _loaddataCount },
                                success: function (response) {
                                    var s = '';
                                    $.each(response.DDData, function (ValData, ValCount) {
                                        var ArrData = ValData.toString().split('[###]');
                                        if ($.inArray(ArrData[1], _selectedSP) > -1) {
                                            s += '<option selected="selected" value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                                        }
                                        else {
                                            s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                                        }
                                    });

                                    //Destroy widgets before reapplying the filter
                                    $("#ToolsCategory").empty();
                                    $("#ToolsCategory").append(s);
                                    $("#ToolsCategory").multiselect("refresh");
                                    $("#ToolsCategory").multiselectfilter("refresh");

                                    var currentNewDataCount = $('select#ToolsCategory option').length;

                                    if (parseInt(currentDataCount) >= parseInt(currentNewDataCount)) {
                                        $(".allreqtoolscategory").hide();
                                        $(".morereqtoolscategory").hide();
                                    }
                                },
                                error: function (response) {
                                    // through errror message
                                }
                            });

                        }
                        else {
                            if (ui.checked) {
                                if ($("#ToolsCategoryCollapse").text().indexOf(ui.text) == -1) {
                                    $("#ToolsCategoryCollapse").append("<span>" + ui.text + "</span>");
                                }
                            }
                            else {
                                if (ui.checked == undefined) {
                                    $("#ToolsCategoryCollapse").html('');
                                }
                                else if (!ui.checked) {
                                    var text = $("#ToolsCategoryCollapse").html();
                                    text = text.replace("<span>" + ui.text + "</span>", '');
                                    $("#ToolsCategoryCollapse").html(text);
                                }
                                else
                                    $("#ToolsCategoryCollapse").html('');
                            }                            
                        }
                        ToolCategoryValue = $.map($(this).multiselect("getChecked"), function (input) {
                            return input.value;
                        })
                        if ($("#ToolsCategoryCollapse").text().trim() != '')
                            $("#ToolsCategoryCollapse").show();
                        else
                            $("#ToolsCategoryCollapse").hide();


                        if ($("#ToolsCategoryCollapse").find('span').length <= 2) {
                            $("#ToolsCategoryCollapse").scrollTop(0).height(50);
                        }
                        else {
                            $("#ToolsCategoryCollapse").scrollTop(0).height(100);
                        }
                        if (event.type != 'multiselectloadmore' && event.type != 'multiselectloadall') {
                            clearGlobalIfNotInFocus();
                            DoNarrowSearchTool();
                        }
                    }).multiselectfilter();
            },
            error: function (response) {
                // through errror message
            }
        });        

        $("#ToolsTechnician").empty();
        $("#ToolsTechnician").multiselect('destroy');
        $("#ToolsTechnician").multiselectfilter('destroy');
        var narrowsearchtext = "Technician";
        if (typeof TechnicianList != 'undefined') {
            narrowsearchtext = TechnicianList;
        }
        $("#ToolsTechnician").multiselect(
            {
                noneSelectedText: narrowsearchtext, selectedList: 5,
                selectedText: function (numChecked, numTotal, checkedItems) {
                    return narrowsearchtext + ': ' + numChecked + ' ' + selected;
                }
            },
            {
                checkAll: function (ui) {
                    $("#ToolsTechnicianCollapse").html('');
                    for (var i = 0; i <= ui.target.length - 1; i++) {
                        if ($("#ToolsTechnicianCollapse").text().indexOf(ui.target[i].text) == -1) {
                            $("#ToolsTechnicianCollapse").append("<span>" + ui.target[i].text + "</span>");
                        }
                    }
                    $("#ToolsTechnicianCollapse").show();
                }
            },
            {
                beforeopen: function () {                    
                    if ($("#ToolsTechnician option").length == 0) {                        
                        $.ajax({
                            'url': '/Master/GetNarrowDDData',
                            data: { TableName: 'ToolMaster', TextFieldName: 'ToolsTechnician', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
                            success: function (response) {
                                var s = '';
                                $.each(response.DDData, function (ValData, ValCount) {
                                    var ArrData = ValData.toString().split('[###]');
                                    s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                                });
                                $("#ToolsTechnician").empty();
                                $("#ToolsTechnician").append(s);
                                $("#ToolsTechnician").multiselect("refresh");
                                $("#ToolsTechnician").multiselectfilter("refresh");
                            },
                            error: function (response) {
                                // through errror message
                            }
                        });
                    }
                }
            }
        )
            .unbind("multiselectclick multiselectcheckall multiselectuncheckall")
            .bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
                if (ui.checked) {
                    if ($("#ToolsTechnicianCollapse").text().indexOf(ui.text) == -1) {
                        $("#ToolsTechnicianCollapse").append("<span>" + ui.text + "</span>");
                    }
                }
                else {
                    if (ui.checked == undefined) {
                        $("#ToolsTechnicianCollapse").html('');
                    }
                    else if (!ui.checked) {
                        var text = $("#ToolsTechnicianCollapse").html();
                        text = text.replace("<span>" + ui.text + "</span>", '');
                        $("#ToolsTechnicianCollapse").html(text);
                    }
                    else
                        $("#ToolsTechnicianCollapse").html('');
                }
                ToolTechnicianValue = $.map($(this).multiselect("getChecked"), function (input) {
                    return input.value;
                })
                if ($("#ToolsTechnicianCollapse").text().trim() != '')
                    $("#ToolsTechnicianCollapse").show();
                else
                    $("#ToolsTechnicianCollapse").hide();


                if ($("#ToolsTechnicianCollapse").find('span').length <= 2) {
                    $("#ToolsTechnicianCollapse").scrollTop(0).height(50);
                }
                else {
                    $("#ToolsTechnicianCollapse").scrollTop(0).height(100);
                }
                clearGlobalIfNotInFocus();
                DoNarrowSearchTool();
            }).multiselectfilter();
        if (pagename == "TechnicianMaster") {
            $.ajax({
                'url': '/Master/GetDDData',
                data: { TableName: 'TechnicianMaster', TextFieldName: 'Technician' },
                success: function (response) {
                    var s = '';
                    $.each(response.DDData, function (i, val) {
                        s += '<option value="' + val.ID + '">' + val.Text + '</option>';
                    });
                    $("#ToolsTechnician").append(s);
                    var narrowsearchtext = "Technician List";
                    if (typeof TechnicianList != 'undefined') {
                        narrowsearchtext = TechnicianList;
                    }
                    $("#ToolsTechnician").multiselect(
                        {
                            noneSelectedText: narrowsearchtext, selectedList: 5,
                            selectedText: function (numChecked, numTotal, checkedItems) {
                                return narrowsearchtext + numChecked + ' ' + selected;
                            }
                        }
                    )
                        .bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
                            TechicianValue = $.map($(this).multiselect("getChecked"), function (input) {
                                return input.value;
                            })
                        });
                },
                error: function (response) {
                    // through errror message
                }
            });
        }
        
        $.ajax({
            'url': '/Master/GetNarrowDDData',
            data: { TableName: 'ToolMaster', TextFieldName: 'CreatedBy', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
            success: function (response) {
                var s = '';
                if (response.DDData != null) {
                    $.each(response.DDData, function (i, val) {
                        var ArrData = i.toString().split('[###]');
                        s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + val + ')' + '</option>';
                    });
                }

                //Destroy widgets before reapplying the filter
                $("#ToolUserCreated").empty();
                $("#ToolUserCreated").append(s);
                $("#ToolUserCreated").multiselect("refresh");
            },
            error: function (response) {
                // through errror message
            }
        });

        $.ajax({
            'url': '/Master/GetNarrowDDData',
            data: { TableName: 'ToolMaster', TextFieldName: 'LastUpdatedBy', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
            success: function (response) {
                var s = '';
                if (response.DDData != null) {
                    $.each(response.DDData, function (i, val) {
                        var ArrData = i.toString().split('[###]');
                        s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + val + ')' + '</option>';
                    });
                }
                //Destroy widgets before reapplying the filter
                $("#ToolUserUpdated").empty();
                $("#ToolUserUpdated").append(s);
                $("#ToolUserUpdated").multiselect("refresh");
            },
            error: function (response) {
                // through errror message
            }
        });

        $.ajax({
            'url': '/Master/GetNarrowDDData',
            data: { TableName: 'ToolMaster', TextFieldName: 'Location', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
            success: function (response) {
                var s = '';
                $.each(response.DDData, function (ValData, ValCount) {
                    var ArrData = ValData.toString().split('[###]');
                    s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                });

                //Destroy widgets before reapplying the filter
                $("#ToolsLocation").empty();
                $("#ToolsLocation").multiselect('destroy');
                $("#ToolsLocation").multiselectfilter('destroy');

                $("#ToolsLocation").append(s);
                var currentDataCount = $('select#ToolsLocation option').length;
                if (parseInt(currentDataCount) < parseInt(loadNarrowSearchDataCount)) {
                    $(".allreqtoolslocation").hide();
                    $(".morereqtoolslocation").hide();
                }
                var narrowsearchtext = "Tools Location";
                if (typeof ToolsLocation != 'undefined') {
                    narrowsearchtext = ToolsLocation;
                }
                $("#ToolsLocation").multiselect(
                    {
                        noneSelectedText: narrowsearchtext, selectedList: 5,
                        selectedText: function (numChecked, numTotal, checkedItems) {
                            return narrowsearchtext + ': ' + numChecked + ' ' + selected;
                        }
                    },
                    {
                        checkAll: function (ui) {
                            $("#ToolsLocationCollapse").html('');
                            for (var i = 0; i <= ui.target.length - 1; i++) {
                                if ($("#ToolsLocationCollapse").text().indexOf(ui.target[i].text) == -1) {
                                    $("#ToolsLocationCollapse").append("<span>" + ui.target[i].text + "</span>");
                                }
                            }
                            $("#ToolsLocationCollapse").show();
                        }
                    }
                )
                    .unbind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall")
                    .bind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall", function (event, ui) {
                        if (event.type == 'multiselectloadmore' || event.type == 'multiselectloadall') {
                            var currentDataCount = $('select#ToolsLocation option').length;
                            var _selectedSP = $.map($(this).multiselect("getChecked"), function (input) {
                                return input.value;
                            });

                            var _loaddataCount = parseInt(currentDataCount) + parseInt(loadNarrowSearchDataCount);                           
                            if (event.type == 'multiselectloadall') {
                                _loaddataCount = -1;
                                $(".allreqtoolslocation").hide();
                                $(".morereqtoolslocation").hide();
                            }
                            $.ajax({
                                'url': '/Master/GetNarrowDDData',
                                data: { TableName: 'ToolMaster', TextFieldName: 'Location', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList', LoadDataCount: _loaddataCount},
                                success: function (response) {
                                    var s = '';
                                    $.each(response.DDData, function (ValData, ValCount) {
                                        var ArrData = ValData.toString().split('[###]');
                                        if ($.inArray(ArrData[1], _selectedSP) > -1) {
                                            s += '<option selected="selected" value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                                        }
                                        else {
                                            s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                                        }
                                    });

                                    //Destroy widgets before reapplying the filter
                                    $("#ToolsLocation").empty();
                                    $("#ToolsLocation").append(s);
                                    $("#ToolsLocation").multiselect("refresh");
                                    $("#ToolsLocation").multiselectfilter("refresh");

                                    var currentNewDataCount = $('select#ToolsLocation option').length;

                                    if (parseInt(currentDataCount) >= parseInt(currentNewDataCount)) {
                                        $(".allreqtoolslocation").hide();
                                        $(".morereqtoolslocation").hide();
                                    }
                                },
                                error: function (response) {
                                    // through errror message
                                }
                            });

                        }
                        else {
                            if (ui.checked) {
                                if ($("#ToolsLocationCollapse").text().indexOf(ui.text) == -1) {
                                    $("#ToolsLocationCollapse").append("<span>" + ui.text + "</span>");
                                }
                            }
                            else {
                                if (ui.checked == undefined) {
                                    $("#ToolsLocationCollapse").html('');
                                }
                                else if (!ui.checked) {
                                    var text = $("#ToolsLocationCollapse").html();
                                    text = text.replace("<span>" + ui.text + "</span>", '');
                                    $("#ToolsLocationCollapse").html(text);
                                }
                                else
                                    $("#ToolsLocationCollapse").html('');
                            }                            
                        }
                        LocationValue = $.map($(this).multiselect("getChecked"), function (input) {
                            return input.value;
                        })
                        if ($("#ToolsLocationCollapse").text().trim() != '')
                            $("#ToolsLocationCollapse").show();
                        else
                            $("#ToolsLocationCollapse").hide();


                        if ($("#ToolsLocationCollapse").find('span').length <= 2) {
                            $("#ToolsLocationCollapse").scrollTop(0).height(50);
                        }
                        else {
                            $("#ToolsLocationCollapse").scrollTop(0).height(100);
                        }
                        if (event.type != 'multiselectloadmore' && event.type != 'multiselectloadall') {
                            clearGlobalIfNotInFocus();
                            DoNarrowSearchTool();
                        }
                    }).multiselectfilter();
            },
            error: function (response) {
                // through errror message
            }
        });

        $.ajax({
            'url': '/Master/GetNarrowDDData',
            data: { TableName: 'ToolMaster', TextFieldName: 'ToolMaintenance', IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: 'ToolList' },
            success: function (response) {
                var s = '';
                $.each(response.DDData, function (ValData, ValCount) {
                    var ArrData = ValData.toString().split('###');
                    s += '<option value="' + ArrData[1] + '">' + ArrData[0] + ' (' + ValCount + ')' + '</option>';
                });

                //Destroy widgets before reapplying the filter
                $("#ToolCheckout").empty();
                $("#ToolCheckout").multiselect('destroy');
                $("#ToolCheckout").multiselectfilter('destroy');
                var narrowsearchtext = "Tools Maintenance";
                if (typeof ToolsMaintenance != 'undefined') {
                    narrowsearchtext = ToolsMaintenance;
                }
                $("#ToolCheckout").append(s);
                $("#ToolCheckout").multiselect(
                            {
                                noneSelectedText: narrowsearchtext, selectedList: 5,
                                selectedText: function (numChecked, numTotal, checkedItems) {
                                    return narrowsearchtext + ': ' + numChecked + ' ' + selected;
                                }
                            },
                            {
                                checkAll: function (ui) {
                                    $("#ToolCheckoutCollapse").html('');
                                    for (var i = 0; i <= ui.target.length - 1; i++) {
                                        if ($("#ToolCheckoutCollapse").text().indexOf(ui.target[i].text) == -1) {
                                            $("#ToolCheckoutCollapse").append("<span>" + ui.target[i].text + "</span>");
                                        }
                                    }
                                    $("#ToolCheckoutCollapse").show();
                                }
                            }
                )
                .bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
                    if (ui.checked) {
                        if ($("#ToolCheckoutCollapse").text().indexOf(ui.text) == -1) {
                            $("#ToolCheckoutCollapse").append("<span>" + ui.text + "</span>");
                        }
                    }
                    else {
                        if (ui.checked == undefined) {
                            $("#ToolCheckoutCollapse").html('');
                        }
                        else if (!ui.checked) {
                            var text = $("#ToolCheckoutCollapse").html();
                            text = text.replace("<span>" + ui.text + "</span>", '');
                            $("#ToolCheckoutCollapse").html(text);
                        }
                        else
                            $("#ToolCheckoutCollapse").html('');
                    }
                    MaintenanceValue = $.map($(this).multiselect("getChecked"), function (input) {
                        return input.value;
                    })

                    if ($("#ToolCheckoutCollapse").text().trim() != '')
                        $("#ToolCheckoutCollapse").show();
                    else
                        $("#ToolCheckoutCollapse").hide();


                    if ($("#ToolCheckoutCollapse").find('span').length <= 2) {
                        $("#ToolCheckoutCollapse").scrollTop(0).height(50);
                    }
                    else {
                        $("#ToolCheckoutCollapse").scrollTop(0).height(100);
                    }
                    clearGlobalIfNotInFocus();
                    DoNarrowSearchTool();
                }).multiselectfilter();
            },
            error: function (response) {
                // through errror message
            }
        });

        //$("#ToolsMaintenance").multiselect({
        //    noneSelectedText: 'Tool Maintenance', selectedList: 5, selectedText: function (numChecked, numTotal, checkedItems) {
        //        return 'Tool Maintenance: ' + numChecked + ' selected';
        //    }
        //}).bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
        //    ToolMaintanceValue = $.map($(this).multiselect("getChecked"), function (input) {
        //        return input.value;
        //    })
        //});
    }

    
    function GetNarroHTMLForUDFTool(tableName, companyID, roomID, _IsArchived, _IsDeleted, _RequisitionCurrentTab, suFix) {
        var UDFObject;
        $("select[name='udflist']").each(function (index) {
            var UDFUniqueID = this.getAttribute('UID');
            if (tableName == "ToolMaster" && this.id.toLowerCase().indexOf("_tool") >= 0) {
                tableName = "ToolCheckOUT";
            }
            $.ajax({
                'url': '/Master/GetUDFDDData',
                data: { TableName: tableName, UDFName: this.id, UDFUniqueID: UDFUniqueID, IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: _RequisitionCurrentTab },
                success: function (response) {
                    var s = '';
                    if (response.DDData != null) {
                        $.each(response.DDData, function (UDFVal, ValCount) {
                            s += '<option value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                        });
                    }

                    var UDFColumnNameTemp = response.UDFColName.toString().replace("_dd", "");

                    //Destroy widgets before reapplying the filter
                    $('[id="' + response.UDFColName + '"]').empty();
                    $('[id="' + response.UDFColName + '"]').multiselect('destroy');
                    $('[id="' + response.UDFColName + '"]').multiselectfilter('destroy');

                    $('[id="' + response.UDFColName + '"]').append(s);

                    var currentDataCount = $('select#' + response.UDFColName + ' option').length;
                    if (parseInt(currentDataCount) < parseInt(loadNarrowSearchDataCount)) {
                        $(".alltoolns" + UDFUniqueID + "").hide();
                        $(".moretoolns" + UDFUniqueID + "").hide();
                    }

                    $('[id="' + response.UDFColName + '"]').multiselect
                        (
                        {
                            noneSelectedText: UDFColumnNameTemp, selectedList: 5,
                            selectedText: function (numChecked, numTotal, checkedItems) {
                                return UDFColumnNameTemp + ' ' + numChecked + ' ' + selected;
                            }
                        },
                        {
                            checkAll: function (ui) {
                                var CollapseObject = $('#' + UDFUniqueID + 'Collapse')
                                $(CollapseObject).html('');
                                for (var i = 0; i <= ui.target.length - 1; i++) {
                                    if ($(CollapseObject).text().indexOf(ui.target[i].text) == -1) {
                                        $(CollapseObject).append("<span>" + ui.target[i].text + "</span>");
                                    }
                                }
                                $(CollapseObject).show();
                            }
                        }
                        )
                        .unbind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall")
                        .bind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall", function (event, ui) {

                            if (event.type == 'multiselectloadmore' || event.type == 'multiselectloadall') {

                                var currentDataCount = $('select#' + this.id + ' option').length;
                                var _selectedTReqUDF = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                });
                                var _loaddataCount = parseInt(currentDataCount) + parseInt(loadNarrowSearchDataCount);
                                if (event.type == 'multiselectloadall') {
                                    _loaddataCount = -1;

                                    $(".alltoolns" + UDFUniqueID + "").hide();
                                    $(".moretoolns" + UDFUniqueID + "").hide();
                                }
                                if (tableName == "ToolCheckOUT" && this.id.toLowerCase().indexOf("_tool") == -1) {
                                    tableName = "ToolMaster";
                                }
                                $.ajax({
                                    'url': '/Master/GetUDFDDData',
                                    data: { TableName: tableName, UDFName: this.id, UDFUniqueID: UDFUniqueID, IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: _RequisitionCurrentTab, NotIncludeDeletedUDF: true, ToolCurrentTab: 'ToolList', LoadDataCount: _loaddataCount },
                                    success: function (responseNew) {
                                        var s = '';
                                        $.each(responseNew.DDData, function (UDFVal, ValCount) {
                                            if ($.inArray(UDFVal, _selectedTReqUDF) > -1) {
                                                s += '<option selected="selected" value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                                            }
                                            else {
                                                s += '<option value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                                            }
                                        });
                                        //Destroy widgets before reapplying the filter
                                        $('[id="' + responseNew.UDFColName + '"]').empty();
                                        $('[id="' + responseNew.UDFColName + '"]').append(s);
                                        $('[id="' + responseNew.UDFColName + '"]').multiselect("refresh");
                                        $('[id="' + responseNew.UDFColName + '"]').multiselectfilter("refresh");

                                        var currentNewDataCount = $('select#' + responseNew.UDFColName + ' option').length;
                                        if (parseInt(currentDataCount) >= parseInt(currentNewDataCount)) {
                                            $(".alltoolns" + UDFUniqueID + "").hide();
                                            $(".moretoolns" + UDFUniqueID + "").hide();
                                        }
                                    },
                                    error: function (responseNew) {
                                        // through errror message
                                    }
                                });

                            }
                            else {
                                var CollapseObject = $('#' + UDFUniqueID + 'Collapse')
                                if (ui.checked) {
                                    if ($(CollapseObject).text().indexOf(ui.text) == -1) {
                                        $(CollapseObject).append("<span>" + ui.text + "</span>");
                                    }
                                }
                                else {
                                    if (ui.checked == undefined) {
                                        $(CollapseObject).html('');
                                    }
                                    else if (!ui.checked) {
                                        var text = $(CollapseObject).html();
                                        text = text.replace("<span>" + ui.text + "</span>", '');
                                        $(CollapseObject).html(text);
                                    }
                                    else
                                        $(CollapseObject).html('');
                                }
                            }
                            if (UDFUniqueID == "UDF1") {
                                UserUDF1NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF2") {
                                UserUDF2NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF3") {
                                UserUDF3NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF4") {
                                UserUDF4NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF5") {
                                UserUDF5NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF6") {
                                UserUDF6NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF7") {
                                UserUDF7NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF8") {
                                UserUDF8NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF9") {
                                UserUDF9NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            else if (UDFUniqueID == "UDF10") {
                                UserUDF10NarrowValues = $.map($(this).multiselect("getChecked"), function (input) {
                                    return input.value;
                                })
                            }
                            if ($(CollapseObject).text().trim() != '')
                                $(CollapseObject).show();
                            else
                                $(CollapseObject).hide();


                            if ($(CollapseObject).find('span').length <= 2) {
                                $(CollapseObject).scrollTop(0).height(50);
                            }
                            else {
                                $(CollapseObject).scrollTop(0).height(100);
                            }
                            if (event.type != 'multiselectloadmore' && event.type != 'multiselectloadall') {
                                clearGlobalIfNotInFocus();
                                DoNarrowSearchTool();
                            }
                        }).multiselectfilter();
                },
                error: function (response) {

                    // through errror message
                }
            });
        });

        if (suFix != null && suFix != '' && suFix != undefined) {
            $("select[name='udflist" + suFix + "']").each(function (index) {                
                var UDFUniqueID = this.getAttribute('UID');
                if (tableName == "ToolMaster" && this.id.toLowerCase().indexOf("_tool") >= 0) {
                    tableName = "ToolCheckOUT";
                }
                $.ajax({
                    'url': '/Master/GetUDFDDData',                    
                    data: { TableName: tableName, UDFName: this.id, UDFUniqueID: UDFUniqueID, IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: _RequisitionCurrentTab, NotIncludeDeletedUDF: true, ToolCurrentTab: 'ToolList' },
                    success: function (response) {
                        var s = '';
                        if (response.DDData != null) {
                            $.each(response.DDData, function (UDFVal, ValCount) {
                                s += '<option value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                            });
                        }
                        var UDFColumnNameTemp = response.UDFColName.toString().replace("_dd", "").replace(suFix, "");


                        //Destroy widgets before reapplying the filter
                        $('[id="' + response.UDFColName + '"]').empty();
                        $('[id="' + response.UDFColName + '"]').multiselect('destroy');
                        $('[id="' + response.UDFColName + '"]').multiselectfilter('destroy');

                        $('[id="' + response.UDFColName + '"]').append(s);
                        var currentDataCount = $('select#' + response.UDFColName + ' option').length;
                        if (parseInt(currentDataCount) < parseInt(loadNarrowSearchDataCount)) {
                            $(".alltoolchkns" + UDFUniqueID + "").hide();
                            $(".moretoolchkns" + UDFUniqueID + "").hide();
                        }

                        $('[id="' + response.UDFColName + '"]').multiselect
                            (
                            {
                                noneSelectedText: UDFColumnNameTemp, selectedList: 5,
                                selectedText: function (numChecked, numTotal, checkedItems) {
                                    return UDFColumnNameTemp + ' ' + numChecked + ' ' + selected;
                                }
                            },
                            {
                                checkAll: function (ui) {
                                    var CollapseObject = $('#' + UDFUniqueID + 'Collapse' + suFix)
                                    $(CollapseObject).html('');

                                    for (var i = 0; i <= ui.target.length - 1; i++) {
                                        if ($(CollapseObject).text().indexOf(ui.target[i].text) == -1) {
                                            $(CollapseObject).append("<span>" + ui.target[i].text + "</span>");
                                        }
                                    }
                                    $(CollapseObject).show();
                                }
                            }
                            )
                            .unbind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall")
                            .bind("multiselectclick multiselectcheckall multiselectuncheckall multiselectloadmore multiselectloadall", function (event, ui) {
                                if (event.type == 'multiselectloadmore' || event.type == 'multiselectloadall') {

                                    var currentDataCount = $('select#' + this.id + ' option').length;
                                    var _selectedHchkUDF = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    });
                                    var _loaddataCount = parseInt(currentDataCount) + parseInt(loadNarrowSearchDataCount);
                                    if (event.type == 'multiselectloadall') {
                                        _loaddataCount = -1;
                                        $(".alltoolchkns" + UDFUniqueID + "").hide();
                                        $(".moretoolchkns" + UDFUniqueID + "").hide();
                                    }
                                    if (tableName == "ToolMaster" && this.id.toLowerCase().indexOf("_tool") >= 0) {
                                        tableName = "ToolCheckOUT";
                                    }
                                    $.ajax({
                                        'url': '/Master/GetUDFDDData',
                                        data: { TableName: tableName, UDFName: this.id, UDFUniqueID: UDFUniqueID, IsArchived: _IsArchived, IsDeleted: _IsDeleted, RequisitionCurrentTab: _RequisitionCurrentTab, NotIncludeDeletedUDF: true, ToolCurrentTab: 'ToolList', LoadDataCount: _loaddataCount },
                                        success: function (responseNew) {
                                            var s = '';
                                            $.each(responseNew.DDData, function (UDFVal, ValCount) {
                                                if ($.inArray(UDFVal, _selectedHchkUDF) > -1) {
                                                    s += '<option selected="selected" value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                                                }
                                                else {
                                                    s += '<option value="' + UDFVal + '">' + UDFVal + ' (' + ValCount + ')' + '</option>';
                                                }
                                            });

                                            //Destroy widgets before reapplying the filter
                                            $('[id="' + responseNew.UDFColName + '"]').empty();
                                            $('[id="' + responseNew.UDFColName + '"]').append(s);
                                            $('[id="' + responseNew.UDFColName + '"]').multiselect("refresh");
                                            $('[id="' + responseNew.UDFColName + '"]').multiselectfilter("refresh");

                                            var currentNewDataCount = $('select#' + responseNew.UDFColName + ' option').length;
                                            if (parseInt(currentDataCount) >= parseInt(currentNewDataCount)) {
                                                $(".alltoolchkns" + UDFUniqueID + "").hide();
                                                $(".moretoolchkns" + UDFUniqueID + "").hide();
                                            }
                                        },
                                        error: function (responseNew) {
                                            // through errror message
                                        }
                                    });

                                }
                                else {
                                    var CollapseObject = $('#' + UDFUniqueID + 'Collapse' + suFix)
                                    if (ui.checked) {
                                        if ($(CollapseObject).text().indexOf(ui.text) == -1) {
                                            $(CollapseObject).append("<span>" + ui.text + "</span>");
                                        }
                                    }
                                    else {
                                        if (ui.checked == undefined) {
                                            $(CollapseObject).html('');
                                        }
                                        else if (!ui.checked) {
                                            var text = $(CollapseObject).html();
                                            text = text.replace("<span>" + ui.text + "</span>", '');
                                            $(CollapseObject).html(text);
                                        }
                                        else
                                            $(CollapseObject).html('');
                                    }
                                }
                                if (UDFUniqueID == "UDF1") {
                                    ToolCheckOutUDF1 = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    })
                                }
                                else if (UDFUniqueID == "UDF2") {
                                    ToolCheckOutUDF2 = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    })
                                }
                                else if (UDFUniqueID == "UDF3") {
                                    ToolCheckOutUDF3 = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    })
                                }
                                else if (UDFUniqueID == "UDF4") {
                                    ToolCheckOutUDF4 = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    })
                                }
                                else {
                                    ToolCheckOutUDF5 = $.map($(this).multiselect("getChecked"), function (input) {
                                        return input.value;
                                    })
                                }
                                if ($(CollapseObject).text().trim() != '')
                                    $(CollapseObject).show();
                                else
                                    $(CollapseObject).hide();


                                if ($(CollapseObject).find('span').length <= 2) {
                                    $(CollapseObject).scrollTop(0).height(50);
                                }
                                else {
                                    $(CollapseObject).scrollTop(0).height(100);
                                }
                                if (event.type != 'multiselectloadmore' && event.type != 'multiselectloadall') {
                                    clearGlobalIfNotInFocus();
                                    DoNarrowSearchTool();
                                }
                            }).multiselectfilter();
                    },
                    error: function (response) {

                        // through errror message
                    }
                });
            });
        }

    }

    function ExpandNarrowSearch() {
        var w = $('.IteamBlock').css("width");
        $('.IteamBlock').show();
        $('.IteamBlock').stop().animate({
            width: "18%"
        }, 0, function () {
            $('.userContent').css({ "width": "80.5%", "margin": "0" });
            $('#myDataTable_length').css({ "left": "0px" });
            $('#myDataTable_paginate').css({ "left": "145px" });
            $('div#divModule').css({ "margin-left": "253px" });
            $('.leftopenContent').css({ "display": "none" });
            setCookie('NarrowSearchState', 'Collapsed');
        });
    }

    function CollapseNarrowSearch() {

        $('.IteamBlock').stop().animate({
            width: "0%"
        }, 0, function () {
            $('.IteamBlock').hide();
            $('.userContent').css({ "width": "98.5%", margin: "0 0.4% 1%" });
            //var Left = $('.viewBlock').css("width");
            var Left = '270px';
            $('#myDataTable_length').css({ "left": Left });
            var LeftW = 145 + parseInt(Left);
            $('#myDataTable_paginate').css({ "left": LeftW + 'px' });
            $('div#divModule').css({ "margin-left": '270px' });
            if (typeof (oTable) != "undefined") {
                oTable.fnAdjustColumnSizing();
            }
            $('.leftopenContent').css({ "display": "" });
            setCookie('NarrowSearchState', 'Expanded');
        });
    }

    function RefreshNarrowSearchCommonly() {
        CallToolNarrowfunctions();
        GetToolsNarrowSearchData(false, false, 'ToolMaster', 'ToolList');
        $('a.downarrow').click(function (e) {
            e.preventDefault();
            $(this).closest('.accordion').find('.dropcontent').slideToggle();
        });
    }

    function GetNarrowDDDataTool(tableName, companyID, roomID, _IsArchived, _IsDeleted) {
        $("#ToolUserCreated").empty();
        $("#ToolUserCreated").multiselect('destroy');
        $("#ToolUserCreated").multiselectfilter('destroy');
        $("#ToolUserCreated").append();
        $("#ToolUserCreated").multiselect({
            noneSelectedText: UserCreatedBy, selectedList: 5, selectedText: function (numChecked, numTotal, checkedItems) {
                return CreatedBy + ' ' + numChecked + ' ' + selected;
            },
            open: function (event, ui) {

            }
        },
            {
                checkAll: function (ui) {
                    $("#ToolUserCreatedCollapse").html('');
                    for (var i = 0; i <= ui.target.length - 1; i++) {
                        if ($("#ToolUserCreatedCollapse").text().indexOf(ui.target[i].text) == -1) {
                            $("#ToolUserCreatedCollapse").append("<span>" + ui.target[i].text + "</span>");
                        }
                    }
                    $("#ToolUserCreatedCollapse").show();
                }
            }
        ).bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
            if (ui.checked) {
                if ($("#ToolUserCreatedCollapse").text().indexOf(ui.text) == -1) {
                    $("#ToolUserCreatedCollapse").append("<span>" + ui.text + "</span>");
                }
            }
            else {
                if (ui.checked == undefined) {
                    $("#ToolUserCreatedCollapse").html('');
                }
                else if (!ui.checked) {
                    var text = $("#ToolUserCreatedCollapse").html();
                    text = text.replace("<span>" + ui.text + "</span>", '');
                    $("#ToolUserCreatedCollapse").html(text);
                }
                else
                    $("#ToolUserCreatedCollapse").html('');
            }
            UserCreatedNarroValues = $.map($(this).multiselect("getChecked"), function (input) {
                return input.value;
            })

            if ($("#ToolUserCreatedCollapse").text().trim() != '')
                $("#ToolUserCreatedCollapse").show();
            else
                $("#ToolUserCreatedCollapse").hide();

            if ($("#ToolUserCreatedCollapse").find('span').length <= 2) {
                $("#ToolUserCreatedCollapse").scrollTop(0).height(50);
            }
            else {
                $("#ToolUserCreatedCollapse").scrollTop(0).height(100);
            }
            clearGlobalIfNotInFocus();
            DoNarrowSearchTool();
        }).multiselectfilter();

        $("#ToolUserUpdated").empty();
        $("#ToolUserUpdated").multiselect('destroy');
        $("#ToolUserUpdated").multiselectfilter('destroy');

        $("#ToolUserUpdated").append();
        $("#ToolUserUpdated").multiselect({
            noneSelectedText: UserUpdatedby, selectedList: 5,
            selectedText: function (numChecked, numTotal, checkedItems) {
                return UpdatedBy + ' ' + numChecked + ' ' + selected;
            }
        },
            {
                checkAll: function (ui) {
                    $("#ToolUserUpdatedCollapse").html('');
                    for (var i = 0; i <= ui.target.length - 1; i++) {
                        if ($("#ToolUserUpdatedCollapse").text().indexOf(ui.target[i].text) == -1) {
                            $("#ToolUserUpdatedCollapse").append("<span>" + ui.target[i].text + "</span>");
                        }
                    }
                    $("#ToolUserUpdatedCollapse").show();
                }
            }
        ).bind("multiselectclick multiselectcheckall multiselectuncheckall", function (event, ui) {
            if (ui.checked) {
                if ($("#ToolUserUpdatedCollapse").text().indexOf(ui.text) == -1) {
                    $("#ToolUserUpdatedCollapse").append("<span>" + ui.text + "</span>");
                }
            }
            else {
                if (ui.checked == undefined) {
                    $("#ToolUserUpdatedCollapse").html('');
                }
                else if (!ui.checked) {
                    var text = $("#ToolUserUpdatedCollapse").html();
                    text = text.replace("<span>" + ui.text + "</span>", '');
                    $("#ToolUserUpdatedCollapse").html(text);
                }
                else
                    $("#ToolUserUpdatedCollapse").html('');
            }
            UserUpdatedNarroValues = $.map($(this).multiselect("getChecked"), function (input) {
                return input.value;
            })

            if ($("#ToolUserUpdatedCollapse").text().trim() != '')
                $("#ToolUserUpdatedCollapse").show();
            else
                $("#ToolUserUpdatedCollapse").hide();

            if ($("#ToolUserUpdatedCollapse").find('span').length <= 2) {
                $("#ToolUserUpdatedCollapse").scrollTop(0).height(50);
            }
            else {
                $("#ToolUserUpdatedCollapse").scrollTop(0).height(100);
            }
            clearGlobalIfNotInFocus();
            DoNarrowSearchTool();
        }).multiselectfilter();


    }


    function DoNarrowSearchTool() {
        var narrowSearchFields = '';
        var narrowSearchValues = '';
        var narrowSearchItem = '';

        eraseCookieforshift("selectstartindex");
        eraseCookieforshift("selectendindex");
        eraseCookieforshift("finalselectedarray");


        if (UserCreatedNarroValues != undefined && UserCreatedNarroValues.length > 0) {
            //narrowSearchItem += "[###]CreatedBy#" + UserCreatedNarroValues;
            narrowSearchFields += "CreatedBy" + ",";
            narrowSearchValues += UserCreatedNarroValues + "@@";
        }
        else {
            narrowSearchFields += "CreatedBy" + ",";
            narrowSearchValues += "@@";
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUpdatedNarroValues != undefined && UserUpdatedNarroValues.length > 0) {
            //narrowSearchItem += "[###]UpdatedBy#" + UserUpdatedNarroValues;
            narrowSearchFields += "UpdatedBy" + ",";
            narrowSearchValues += UserUpdatedNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UpdatedBy" + ",";
            narrowSearchValues += "@@";
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////
        if (($('#ToolDateCFrom').val() != '' && $('#ToolDateCTo').val() != '') || ($('#ReceiveDateCFrom').val() != '' && $('#ReceiveDateCTo').val() != '')) {
            //narrowSearchItem += "[###]DateCreatedFrom#" + GetDateInYYYYMMDDFormat($('#DateCFrom').val()) + "#DateCreatedTo#" + GetDateInYYYYMMDDFormat($('#DateCTo').val());
            narrowSearchFields += "DateCreatedFrom" + ",";

            if (typeof $('#ToolDateCTo').val() != "undefined" && typeof $('#ToolDateCFrom').val() != "undefined" && $('#ToolDateCFrom').val() != '' && $('#ToolDateCTo').val() != '')
                narrowSearchValues += ($('#ToolDateCFrom').val()) + "," + ($('#ToolDateCTo').val()) + "@@";
            else if (typeof $('#ReceiveDateCFrom').val() != "undefined" && typeof $('#ReceiveDateCTo').val() != "undefined" && $('#ReceiveDateCFrom').val() != '' && $('#ReceiveDateCTo').val() != '')
                narrowSearchValues += ($('#ReceiveDateCFrom').val()) + "," + ($('#ReceiveDateCTo').val()) + "@@";
            else
                narrowSearchValues += "@@";
        }
        else {
            narrowSearchFields += "DateCreatedFrom" + ",";
            narrowSearchValues += "@@";
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if (($('#ToolDateUFrom').val() != '' && $('#ToolDateUTo').val() != '') || ($('#ReceiveDateUFrom').val() != '' && $('#ReceiveDateUTo').val() != '')) {
            //narrowSearchItem += "[###]DateUpdatedFrom#" + GetDateInYYYYMMDDFormat($('#DateUFrom').val()) + "#DateUpdatedTo#" + GetDateInYYYYMMDDFormat($('#DateUTo').val());
            narrowSearchFields += "DateUpdatedFrom" + ",";
            if (typeof $('#ToolDateUFrom').val() != "undefined" && typeof $('#ToolDateUTo').val() != "undefined" && $('#ToolDateUTo').val() != '' && $('#ToolDateUFrom').val() != '')
                narrowSearchValues += ($('#ToolDateUFrom').val()) + "," + ($('#ToolDateUTo').val()) + "@@";
            else if (typeof $('#ReceiveDateUFrom').val() != "undefined" && typeof $('#ReceiveDateUTo').val() != "undefined" && $('#ReceiveDateUTo').val() != '' && $('#ReceiveDateUFrom').val() != '')
                narrowSearchValues += ($('#ReceiveDateUFrom').val()) + "," + ($('#ReceiveDateUTo').val()) + "@@";
            else
                narrowSearchValues += "@@";
        }
        else {
            narrowSearchFields += "DateUpdatedFrom" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF1NarrowValues != undefined && UserUDF1NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "UDF1" + ",";
            narrowSearchValues += UserUDF1NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF1" + ",";
            narrowSearchValues += "@@";
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF2NarrowValues != undefined && UserUDF2NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF2#" + UserUDF2NarrowValues;
            narrowSearchFields += "UDF2" + ",";
            narrowSearchValues += UserUDF2NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF2" + ",";
            narrowSearchValues += "@@";
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF3NarrowValues != undefined && UserUDF3NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF3#" + UserUDF3NarrowValues;
            narrowSearchFields += "UDF3" + ",";
            narrowSearchValues += UserUDF3NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF3" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF4NarrowValues != undefined && UserUDF4NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF4#" + UserUDF4NarrowValues;
            narrowSearchFields += "UDF4" + ",";
            narrowSearchValues += UserUDF4NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF4" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF5NarrowValues != undefined && UserUDF5NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF5#" + UserUDF5NarrowValues;
            narrowSearchFields += "UDF5" + ",";
            narrowSearchValues += UserUDF5NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF5" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (PullSupplierNarroValues != undefined && PullSupplierNarroValues.length > 0) {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += PullSupplierNarroValues + "@@";
        }
        else {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////////////////////////////////////////////////////////////
        if (ManufacturerNarroValues != undefined && ManufacturerNarroValues.length > 0) {
            narrowSearchFields += "ManufacturerID" + ",";
            narrowSearchValues += ManufacturerNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ManufacturerID" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////////////////////////////////////////////////////////////
        if (PullCategoryNarroValues != undefined && PullCategoryNarroValues.length > 0) {
            narrowSearchFields += "CategoryID" + ",";
            narrowSearchValues += PullCategoryNarroValues + "@@";
        }
        else {
            narrowSearchFields += "CategoryID" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////
        if (OrderSupplierNarroValues != undefined && OrderSupplierNarroValues.length > 0) {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += OrderSupplierNarroValues + "@@";
        }
        else {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////
        if (OrderStatusNarroValues != undefined && OrderStatusNarroValues.length > 0) {
            narrowSearchFields += "OrderStatus" + ",";
            narrowSearchValues += OrderStatusNarroValues + "@@";
        }
        else {
            narrowSearchFields += "OrderStatus" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////
        if (OrderRequiredDateNarroValues != undefined && OrderRequiredDateNarroValues.length > 0) {
            narrowSearchFields += "OrderRequiredDate" + ",";
            narrowSearchValues += OrderRequiredDateNarroValues + "@@";
        }
        else {
            narrowSearchFields += "OrderRequiredDate" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////15//////////////////////////////////////////////////////////

        if (CostNarroSearchValue != undefined && CostNarroSearchValue.length > 0) {
            narrowSearchFields += "Cost" + ",";
            narrowSearchValues += CostNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "Cost" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////16//////////////////////////////////////////////////////////

        if (spendPerSpendLimit != undefined && spendPerSpendLimit.length > 0) {
            narrowSearchFields += "spendPerSpendLimit" + ",";
            narrowSearchValues += spendPerSpendLimit + "@@";
        }
        else {
            narrowSearchFields += "spendPerSpendLimit" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////17//////////////////////////////////////////////////////////

        if (TotalSpendLimit != undefined && TotalSpendLimit.length > 0) {
            narrowSearchFields += "TotalSpendLimit" + ",";
            narrowSearchValues += TotalSpendLimit + "@@";
        }
        else {
            narrowSearchFields += "TotalSpendLimit" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////18//////////////////////////////////////////////////////////

        if (TotalSpendRemaining != undefined && TotalSpendRemaining.length > 0) {
            narrowSearchFields += "TotalSpendRemaining" + ",";
            narrowSearchValues += TotalSpendRemaining + "@@";
        }
        else {
            narrowSearchFields += "TotalSpendRemaining" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////19//////////////////////////////////////////////////////////

        if (TotalItemSpendLimit != undefined && TotalItemSpendLimit.length > 0) {
            narrowSearchFields += "TotalItemSpendLimit" + ",";
            narrowSearchValues += TotalItemSpendLimit + "@@";
        }
        else {
            narrowSearchFields += "TotalItemSpendLimit" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////20//////////////////////////////////////////////////////////

        if (MatStagLocationsNarroValues != undefined && MatStagLocationsNarroValues.length > 0) {
            narrowSearchFields += "BinName" + ",";
            narrowSearchValues += MatStagLocationsNarroValues + "@@";
        }
        else {
            narrowSearchFields += "BinName" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////21//////////////////////////////////////////////////////////

        if (SSNarroSearchValue != undefined && SSNarroSearchValue.length > 0) {
            narrowSearchFields += "SS" + ",";
            narrowSearchValues += SSNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "SS" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////22//////////////////////////////////////////////////////////

        if (ItemTypeNarroSearchValue != undefined && ItemTypeNarroSearchValue.length > 0) {
            narrowSearchFields += "ItemType" + ",";
            narrowSearchValues += ItemTypeNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "ItemType" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////23//////////////////////////////////////////////////////////

        if (CartSupplierNarroValues != undefined && CartSupplierNarroValues.length > 0) {
            narrowSearchFields += "SupplierName" + ",";
            narrowSearchValues += CartSupplierNarroValues + "@@";
        }
        else {
            narrowSearchFields += "SupplierName" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////24//////////////////////////////////////////////////////////

        if (CartRTNarroValues != undefined && CartRTNarroValues.length > 0) {
            narrowSearchFields += "ReplenishType" + ",";
            narrowSearchValues += CartRTNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ReplenishType" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////25//////////////////////////////////////////////////////////

        if (RequisitionCurrentTab != undefined && RequisitionCurrentTab.length > 0) {

            narrowSearchFields += "RequisitionStatus" + ",";
            narrowSearchValues += RequisitionCurrentTab + "@@";
        }
        else {

            narrowSearchFields += "RequisitionStatus" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////26//////////////////////////////////////////////////////////
        if (OrderNumberNarroValues != undefined && OrderNumberNarroValues.length > 0) {
            narrowSearchFields += "OrderNumber" + ",";
            narrowSearchValues += OrderNumberNarroValues + "@@";
        }
        else {
            narrowSearchFields += "OrderNumber" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////27//////////////////////////////////////////////////////////
        if (LocationValue != undefined && LocationValue.length > 0) {
            narrowSearchFields += "LocationID" + ",";
            narrowSearchValues += LocationValue + "@@";
        }
        else {
            narrowSearchFields += "LocationID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////28//////////////////////////////////////////////////////////
        if (WorkOrderValue != undefined && WorkOrderValue.length > 0) {
            narrowSearchFields += "WorkOrderID" + ",";
            narrowSearchValues += WorkOrderValue + "@@";
        }
        else {
            narrowSearchFields += "WorkOrderID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////29//////////////////////////////////////////////////////////
        if (ToolCategoryValue != undefined && ToolCategoryValue.length > 0) {
            narrowSearchFields += "ToolCategoryID" + ",";
            narrowSearchValues += ToolCategoryValue + "@@";
        }
        else {
            narrowSearchFields += "ToolCategoryID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////30//////////////////////////////////////////////////////////
        if (ToolMaintanceValue != undefined && ToolMaintanceValue.length > 0) {
            narrowSearchFields += "ToolMaintanenceID" + ",";
            narrowSearchValues += ToolMaintanceValue + "@@";
        }
        else {
            narrowSearchFields += "ToolMaintanenceID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////31//////////////////////////////////////////////////////////
        if (ToolCostValue != undefined && ToolCostValue.length > 0) {
            narrowSearchFields += "Cost" + ",";
            narrowSearchValues += ToolCostValue + "@@";
        }
        else {
            narrowSearchFields += "Cost" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////32//////////////////////////////////////////////////////////
        if (WOAssetValues != undefined && WOAssetValues.length > 0) {
            narrowSearchFields += "AssetID" + ",";
            narrowSearchValues += WOAssetValues + "@@";
        }
        else {
            narrowSearchFields += "AssetID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////33//////////////////////////////////////////////////////////
        if (WOCustomerValues != undefined && WOCustomerValues.length > 0) {
            narrowSearchFields += "CustomerID" + ",";
            narrowSearchValues += WOCustomerValues + "@@";
        }
        else {
            narrowSearchFields += "CustomerID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////34//////////////////////////////////////////////////////////
        if (WOTechnicianValues != undefined && WOTechnicianValues.length > 0) {
            narrowSearchFields += "TechnicianID" + ",";
            narrowSearchValues += WOTechnicianValues + "@@";
        }
        else {
            narrowSearchFields += "TechnicianID" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////35//////////////////////////////////////////////////////////
        if (WOToolValues != undefined && WOToolValues.length > 0) {
            narrowSearchFields += "ToolID" + ",";
            narrowSearchValues += WOToolValues + "@@";
        }
        else {
            narrowSearchFields += "ToolID" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////36//////////////////////////////////////////////////////////
        if (RoleUserTypeNarroValues != undefined && RoleUserTypeNarroValues.length > 0) {
            narrowSearchFields += "UserType" + ",";
            narrowSearchValues += RoleUserTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserType" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////37//////////////////////////////////////////////////////////
        if (ICountTypeNarroValues != undefined && ICountTypeNarroValues.length > 0) {
            narrowSearchFields += "CountType" + ",";
            narrowSearchValues += ICountTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "CountType" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////38//////////////////////////////////////////////////////////
        if (ICountStatusNarroValues != undefined && ICountStatusNarroValues.length > 0) {
            narrowSearchFields += "CountStatus" + ",";
            narrowSearchValues += ICountStatusNarroValues + "@@";
        }
        else {
            narrowSearchFields += "CountStatus" + ",";
            narrowSearchValues += "@@";
        }
        //narrowSearch = 'STARTWITH#' + narrowSearchItem;


        //////////////////////////////////////39//////////////////////////////////////////////////////////
        if (UserTypeNarroValues != undefined && UserTypeNarroValues.length > 0) {
            narrowSearchFields += "UserType" + ",";
            narrowSearchValues += UserTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserType" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////40//////////////////////////////////////////////////////////
        if (UserRoomNarroValues != undefined && UserRoomNarroValues.length > 0) {
            narrowSearchFields += "UserRoom" + ",";
            narrowSearchValues += UserRoomNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserRoom" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////41//////////////////////////////////////////////////////////
        if (UserRoleNarroValues != undefined && UserRoleNarroValues.length > 0) {
            narrowSearchFields += "UserRole" + ",";
            narrowSearchValues += UserRoleNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserRole" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////42//////////////////////////////////////////////////////////
        if (UserCompanyNarroValues != undefined && UserCompanyNarroValues.length > 0) {
            narrowSearchFields += "UserCompany" + ",";
            narrowSearchValues += UserCompanyNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserCompany" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////43//////////////////////////////////////////////////////////
        if (RoleRoomNarroValues != undefined && RoleRoomNarroValues.length > 0) {
            narrowSearchFields += "RoleRoom" + ",";
            narrowSearchValues += RoleRoomNarroValues + "@@";
        }
        else {
            narrowSearchFields += "RoleRoom" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////44//////////////////////////////////////////////////////////

        if (RoleCompanyNarroValues != undefined && RoleCompanyNarroValues.length > 0) {
            narrowSearchFields += "RoleCompany" + ",";
            narrowSearchValues += RoleCompanyNarroValues + "@@";
        }
        else {
            narrowSearchFields += "RoleCompany" + ",";
            narrowSearchValues += "@@";
        }

        ///////////////////////////////////45/////////////////////////////////////////////////////////////
        if (SchedulerItemSearchValue != undefined && SchedulerItemSearchValue.length > 0) {
            narrowSearchFields += "SchedulerItem" + ",";
            narrowSearchValues += SchedulerItemSearchValue + "@@";
        }
        else {
            narrowSearchFields += "SchedulerItem" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////46//////////////////////////////////////////////////////////////
        if (SchedulerTypeSearchValue != undefined && SchedulerTypeSearchValue.length > 0) {
            narrowSearchFields += "SchedulerType" + ",";
            narrowSearchValues += SchedulerTypeSearchValue + "@@";
        }
        else {
            narrowSearchFields += "SchedulerType" + ",";
            narrowSearchValues += "@@";
        }
        if (WorkOrderNarroValues != undefined && WorkOrderNarroValues.length > 0) {

            narrowSearchFields += "WorkOrderName" + ",";
            narrowSearchValues += WorkOrderNarroValues + "@@";
        }
        else {
            narrowSearchFields += "WorkOrderName" + ",";
            narrowSearchValues += "@@";
        }
        if (AverageCostNarroSearchValue != undefined && AverageCostNarroSearchValue.length > 0) {

            narrowSearchFields += "AverageCost" + ",";
            narrowSearchValues += AverageCostNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "AverageCost" + ",";
            narrowSearchValues += "@@";
        }
        if (TurnsNarroSearchValue != undefined && TurnsNarroSearchValue.length > 0) {

            narrowSearchFields += "Turns" + ",";
            narrowSearchValues += TurnsNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "Turns" + ",";
            narrowSearchValues += "@@";
        }

        if (PullActionTypeNarroSearchValue != undefined && PullActionTypeNarroSearchValue.length > 0) {

            narrowSearchFields += "ActionType" + ",";
            narrowSearchValues += PullActionTypeNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "ActionType" + ",";
            narrowSearchValues += "@@";
        }


        //////////////////////////////////////38//////////////////////////////////////////////////////////
        if (ntfcEmailTemlateNarroValues != undefined && ntfcEmailTemlateNarroValues.length > 0) {
            narrowSearchFields += "EmailTemplate" + ",";
            narrowSearchValues += ntfcEmailTemlateNarroValues + "@@";
        }
        else {
            narrowSearchFields += "EmailTemplate" + ",";
            narrowSearchValues += "@@";
        }


        //////////////////////////////////////38//////////////////////////////////////////////////////////
        if (ntfcReportsNarroValues != undefined && ntfcReportsNarroValues.length > 0) {
            narrowSearchFields += "Reports" + ",";
            narrowSearchValues += ntfcReportsNarroValues + "@@";
        }
        else {
            narrowSearchFields += "Reports" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////38//////////////////////////////////////////////////////////
        if (ntfcScheduleNarroValues != undefined && ntfcScheduleNarroValues.length > 0) {
            narrowSearchFields += "Schedules" + ",";
            narrowSearchValues += ntfcScheduleNarroValues + "@@";
        }
        else {
            narrowSearchFields += "Schedules" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////38//////////////////////////////////////////////////////////
        if (ntfcNotificationTypeNarroValues != undefined && ntfcNotificationTypeNarroValues.length > 0) {
            narrowSearchFields += "NotificationTypes" + ",";
            narrowSearchValues += ntfcNotificationTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "NotificationTypes" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////////////////////////////////////////////////////////////
        if (ItemLocationNarroValues != undefined && ItemLocationNarroValues.length > 0) {
            narrowSearchFields += "ItemLocations" + ",";
            narrowSearchValues += ItemLocationNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ItemLocations" + ",";
            narrowSearchValues += "@@";
        }

        if (EnterpriseNarroValues != undefined && EnterpriseNarroValues.length > 0) {
            narrowSearchFields += "EnterpriseName" + ",";
            narrowSearchValues += EnterpriseNarroValues + "@@";
        }
        else {
            narrowSearchFields += "EnterpriseName" + ",";
            narrowSearchValues += "@@";
        }

        if (RoleCompanyNarroValues != undefined && RoleCompanyNarroValues.length > 0) {
            narrowSearchFields += "CompanyName" + ",";
            narrowSearchValues += RoleCompanyNarroValues + "@@";
        }
        else {
            narrowSearchFields += "EnterpriseName" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (PullProjectSpendNarroValues != undefined && PullProjectSpendNarroValues.length > 0) {
            narrowSearchFields += "ProjectSpendID" + ",";
            narrowSearchValues += PullProjectSpendNarroValues + "@@";
        }
        else {

            narrowSearchFields += "ProjectSpendID" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (PullWorkOrderValues != undefined && PullWorkOrderValues.length > 0) {
            narrowSearchFields += "WorkOrderID" + ",";
            narrowSearchValues += PullWorkOrderValues + "@@";
        }
        else {
            narrowSearchFields += "WorkOrderID" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (PullRequistionarroValues != undefined && PullRequistionarroValues.length > 0) {
            narrowSearchFields += "RequistionID" + ",";
            narrowSearchValues += PullRequistionarroValues + "@@";
        }
        else {
            narrowSearchFields += "RequistionID" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////
        if (IsBillingNarroSearchValue != undefined && IsBillingNarroSearchValue.length > 0) {
            narrowSearchFields += "Billing" + ",";
            narrowSearchValues += IsBillingNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "Billing" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////////////////////////////////////////////////////////
        if (IsEDISentNarroSearchValue != undefined && IsEDISentNarroSearchValue.length > 0) {
            narrowSearchFields += "IsEDISent" + ",";
            narrowSearchValues += IsEDISentNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "IsEDISent" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (AvgUsageNarroSearchValue != undefined && AvgUsageNarroSearchValue.length > 0) {
            narrowSearchFields += "AverageUsage" + ",";
            narrowSearchValues += AvgUsageNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "AverageUsage" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (TurnsNarroSearchValue != undefined && TurnsNarroSearchValue.length > 0) {
            narrowSearchFields += "Turns" + ",";
            narrowSearchValues += TurnsNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "Turns" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemUDF1 != undefined && ItemUDF1.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ItemUDF1" + ",";
            narrowSearchValues += ItemUDF1 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF1" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemUDF2 != undefined && ItemUDF2.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ItemUDF2" + ",";
            narrowSearchValues += ItemUDF2 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF2" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemUDF3 != undefined && ItemUDF3.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ItemUDF3" + ",";
            narrowSearchValues += ItemUDF3 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF3" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemUDF4 != undefined && ItemUDF4.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ItemUDF4" + ",";
            narrowSearchValues += ItemUDF4 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF4" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemUDF5 != undefined && ItemUDF5.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ItemUDF5" + ",";
            narrowSearchValues += ItemUDF5 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF5" + ",";
            narrowSearchValues += "@@";
        }
        if (RoomStatusValue != undefined && RoomStatusValue.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "RoomStatusValue" + ",";
            narrowSearchValues += RoomStatusValue + "@@";
        }
        else {
            narrowSearchFields += "RoomStatusValue" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolCheckOutUDF1 != undefined && ToolCheckOutUDF1.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolCheckOutUDF1" + ",";
            narrowSearchValues += ToolCheckOutUDF1 + "@@";
        }
        else {
            narrowSearchFields += "ToolCheckOutUDF1" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolCheckOutUDF2 != undefined && ToolCheckOutUDF2.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolCheckOutUDF2" + ",";
            narrowSearchValues += ToolCheckOutUDF2 + "@@";
        }
        else {
            narrowSearchFields += "ToolCheckOutUDF2" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolCheckOutUDF3 != undefined && ToolCheckOutUDF3.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolCheckOutUDF3" + ",";
            narrowSearchValues += ToolCheckOutUDF3 + "@@";
        }
        else {
            narrowSearchFields += "ToolCheckOutUDF3" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolCheckOutUDF4 != undefined && ToolCheckOutUDF4.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolCheckOutUDF4" + ",";
            narrowSearchValues += ToolCheckOutUDF4 + "@@";
        }
        else {
            narrowSearchFields += "ToolCheckOutUDF4" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolCheckOutUDF5 != undefined && ToolCheckOutUDF5.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolCheckOutUDF5" + ",";
            narrowSearchValues += ToolCheckOutUDF5 + "@@";
        }
        else {
            narrowSearchFields += "ToolCheckOutUDF5" + ",";
            narrowSearchValues += "@@";
        }

        if (ToolCheckoutValue != undefined && ToolCheckoutValue.length > 0) {
            narrowSearchFields += "Maintense" + ",";
            narrowSearchValues += ToolCheckoutValue + "@@";
        }
        else {
            narrowSearchFields += "Maintense" + ",";
            narrowSearchValues += "@@";
        }
        if (ToolTechnicianValue != undefined && ToolTechnicianValue.length > 0) {
            narrowSearchFields += "ToolTechnician" + ",";
            narrowSearchValues += ToolTechnicianValue + "@@";
        }
        else {
            narrowSearchFields += "ToolTechnician" + ",";
            narrowSearchValues += "@@";
        }
        if (PullOrderNumbernarroValues != undefined && PullOrderNumbernarroValues.length > 0) {
            narrowSearchFields += "OrderNumber" + ",";
            narrowSearchValues += PullOrderNumbernarroValues + "@@";
        }
        else {
            narrowSearchFields += "OrderNumber" + ",";
            narrowSearchValues += "@@";
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if (UserEnterpriseNarroValues != undefined && UserEnterpriseNarroValues.length > 0) {
            narrowSearchFields += "UserEnterprise" + ",";
            narrowSearchValues += UserEnterpriseNarroValues + "@@";
        }
        else {
            narrowSearchFields += "UserEnterprise" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////80///////////////////////////////////////////////////////
        if (MoveTypeNarroValues != undefined && MoveTypeNarroValues.length > 0) {
            narrowSearchFields += "MoveType" + ",";
            narrowSearchValues += MoveTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "MoveType" + ",";
            narrowSearchValues += "@@";
        }
        if (MouleTypeNarroValues != undefined && MouleTypeNarroValues.length > 0) {
            narrowSearchFields += "ModuleType" + ",";
            narrowSearchValues += MouleTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ModuleType" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemsNarroValues != undefined && ItemsNarroValues.length > 0) {
            narrowSearchFields += "Items" + ",";
            narrowSearchValues += ItemsNarroValues + "@@";
        }
        else {
            narrowSearchFields += "Items" + ",";
            narrowSearchValues += "@@";
        }
        if (UserSupplierNarroValues != undefined && UserSupplierNarroValues.length > 0) {
            narrowSearchFields += "Supplier" + ",";
            narrowSearchValues += UserSupplierNarroValues + "@@";
        }
        else {
            narrowSearchFields += "Supplier" + ",";
            narrowSearchValues += "@@";
        }
        if (CateogryNarroValues != undefined && CateogryNarroValues.length > 0) {
            narrowSearchFields += "Category" + ",";
            narrowSearchValues += CateogryNarroValues + "@@";
        }
        else {
            narrowSearchFields += "Category" + ",";
            narrowSearchValues += "@@";
        }
        if (PullPOStatusValue != undefined && PullPOStatusValue.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "PullPOStatusValue" + ",";
            narrowSearchValues += PullPOStatusValue + "@@";
        }
        else {
            narrowSearchFields += "PullPOStatusValue" + ",";
            narrowSearchValues += "@@";
        }

        if (CompanyStatusValue != undefined && CompanyStatusValue.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "CompanyStatusValue" + ",";
            narrowSearchValues += CompanyStatusValue + "@@";
        }
        else {
            narrowSearchFields += "CompanyStatusValue" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////////////////////////////////////////////////////////////////
        if (InventoryClassificationNarroSearchValue != undefined && InventoryClassificationNarroSearchValue.length > 0) {
            narrowSearchFields += "InventoryClassification" + ",";
            narrowSearchValues += InventoryClassificationNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "InventoryClassification" + ",";
            narrowSearchValues += "@@";
        }
        //ItemLocations
        if (ItemTrackingTypeNarroValues != undefined && ItemTrackingTypeNarroValues.length > 0) {
            narrowSearchFields += "ItemTrackingType" + ",";
            narrowSearchValues += ItemTrackingTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ItemTrackingType" + ",";
            narrowSearchValues += "@@";
        }

        if (StockStatusTypeNarroValues != undefined && StockStatusTypeNarroValues.length > 0) {
            narrowSearchFields += "StockStatus" + ",";
            narrowSearchValues += StockStatusTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "StockStatus" + ",";
            narrowSearchValues += "@@";
        }
        if (WOSupplierValues != undefined && WOSupplierValues.length > 0) {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += WOSupplierValues + "@@";
        }
        else {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += "@@";
        }
        if (RequistionSupplierValues != undefined && RequistionSupplierValues.length > 0) {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += RequistionSupplierValues + "@@";
        }
        else {
            narrowSearchFields += "SupplierID" + ",";
            narrowSearchValues += "@@";
        }



        if (UserUDF6NarrowValues != undefined && UserUDF6NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "UDF6" + ",";
            narrowSearchValues += UserUDF6NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF6" + ",";
            narrowSearchValues += "@@";
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF7NarrowValues != undefined && UserUDF7NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF2#" + UserUDF2NarrowValues;
            narrowSearchFields += "UDF7" + ",";
            narrowSearchValues += UserUDF7NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF7" + ",";
            narrowSearchValues += "@@";
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF8NarrowValues != undefined && UserUDF8NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF3#" + UserUDF3NarrowValues;
            narrowSearchFields += "UDF8" + ",";
            narrowSearchValues += UserUDF8NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF8" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF9NarrowValues != undefined && UserUDF9NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF4#" + UserUDF4NarrowValues;
            narrowSearchFields += "UDF9" + ",";
            narrowSearchValues += UserUDF9NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF9" + ",";
            narrowSearchValues += "@@";
        }
        /////////////////////////////////////////////////////////////////////////////////////////////
        if (UserUDF10NarrowValues != undefined && UserUDF10NarrowValues.length > 0) {
            //narrowSearchItem += "[###]UDF5#" + UserUDF5NarrowValues;
            narrowSearchFields += "UDF10" + ",";
            narrowSearchValues += UserUDF10NarrowValues + "@@";
        }
        else {
            narrowSearchFields += "UDF10" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemActive != undefined && ItemActive.length > 0) {
            narrowSearchFields += "IsActive" + ",";
            narrowSearchValues += ItemActive + "@@";
        }
        else {
            narrowSearchFields += "IsActive" + ",";
            narrowSearchValues += "@@";
        }
        if (RoleEnterpriseNarroValues != undefined && RoleEnterpriseNarroValues.length > 0) {
            narrowSearchFields += "RoleEnterprise" + ",";
            narrowSearchValues += RoleEnterpriseNarroValues + "@@";
        }
        else {
            narrowSearchFields += "RoleEnterprise" + ",";
            narrowSearchValues += "@@";
        }
        if (ItemNumberItemBinNarroValues != undefined && ItemNumberItemBinNarroValues.length > 0) {
            narrowSearchFields += "ItemNumber" + ",";
            narrowSearchValues += ItemNumberItemBinNarroValues + "@@";
        }
        else {
            narrowSearchFields += "ItemNumber" + ",";
            narrowSearchValues += "@@";
        }
        if (BinListItemBinNarroValues != undefined && BinListItemBinNarroValues.length > 0) {
            narrowSearchFields += "BinNumber" + ",";
            narrowSearchValues += BinListItemBinNarroValues + "@@";
        }
        else {
            narrowSearchFields += "BinNumber" + ",";
            narrowSearchValues += "@@";
        }
        //////////////////////////////////////27//////////////////////////////////////////////////////////
        if (MaintenanceValue != undefined && MaintenanceValue.length > 0) {
            narrowSearchFields += "MaintenanceValue" + ",";
            narrowSearchValues += MaintenanceValue + "@@";
        }
        else {
            narrowSearchFields += "MaintenanceValue" + ",";
            narrowSearchValues += "@@";
        }


        //////////////////////////////////////////////////////////////////////////////////////////////
        if (BillingRoomTypeTypeNarroValues != undefined && BillingRoomTypeTypeNarroValues.length > 0) {
            narrowSearchFields += "BillingRoomType" + ",";
            narrowSearchValues += BillingRoomTypeTypeNarroValues + "@@";
        }
        else {
            narrowSearchFields += "BillingRoomType" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////////////////////////////////////////////////////////////
        if (InvoiceBranchNarroValues != undefined && InvoiceBranchNarroValues.length > 0) {
            narrowSearchFields += "InvoiceBranch" + ",";
            narrowSearchValues += InvoiceBranchNarroValues + "@@";
        }
        else {
            narrowSearchFields += "InvoiceBranch" + ",";
            narrowSearchValues += "@@";
        }

        ////////////////////////////////////////104 [Requisition Status Narrow Search]////////////////////////////////////////////////
        if (ddlRequisitionStatusNarroValues != undefined && ddlRequisitionStatusNarroValues.length > 0) {

            narrowSearchFields += "RequisitionStatusNS" + ",";
            narrowSearchValues += ddlRequisitionStatusNarroValues + "@@";
        }
        else {

            narrowSearchFields += "RequisitionStatusNS" + ",";
            narrowSearchValues += "@@";
        }

        ////////////////////////////////////////105 [Pull Consignment Narrow Search]////////////////////////////////////////////////

        if (PullConsignmentNarroSearchValue != undefined && PullConsignmentNarroSearchValue.length > 0) {

            narrowSearchFields += "Consignment" + ",";
            narrowSearchValues += PullConsignmentNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "Consignment" + ",";
            narrowSearchValues += "@@";
        }


        //////////////////////////////////////106 [Asset Category Narrow Search] //////////////////////////////////////////////////////////
        if (AssetCategoryValue != undefined && AssetCategoryValue.length > 0) {
            narrowSearchFields += "AssetCategoryID" + ",";
            narrowSearchValues += AssetCategoryValue + "@@";
        }
        else {
            narrowSearchFields += "AssetCategoryID" + ",";
            narrowSearchValues += "@@";
        }





        ////////////////////////////////////////107 [work order WOType Option in Narrowsearch]////////////////////////////////////////////////
        if (WOTypeValues != undefined && WOTypeValues.length > 0) {
            narrowSearchFields += "WOType" + ",";
            narrowSearchValues += WOTypeValues + "@@";
        }
        else {
            narrowSearchFields += "WOType" + ",";
            narrowSearchValues += "@@";
        }

        //////////////////////////////////////108 [Report Type option in Narrowsearch]///////////////////////////////////////////////////////
        if (ReportTypeNarroSearchValue != undefined && ReportTypeNarroSearchValue.length > 0) {
            narrowSearchFields += "ReportType" + ",";
            narrowSearchValues += ReportTypeNarroSearchValue + "@@";
        }
        else {
            narrowSearchFields += "ReportType" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////109////////////////////////////////////////////////////

        if (ItemUDF6 != undefined && ItemUDF6.length > 0) {
            narrowSearchFields += "ItemUDF6" + ",";
            narrowSearchValues += ItemUDF6 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF6" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////110////////////////////////////////////////////////////

        if (ItemUDF7 != undefined && ItemUDF7.length > 0) {
            narrowSearchFields += "ItemUDF7" + ",";
            narrowSearchValues += ItemUDF7 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF7" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////111////////////////////////////////////////////////////

        if (ItemUDF8 != undefined && ItemUDF8.length > 0) {
            narrowSearchFields += "ItemUDF8" + ",";
            narrowSearchValues += ItemUDF8 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF8" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////112////////////////////////////////////////////////////

        if (ItemUDF9 != undefined && ItemUDF9.length > 0) {
            narrowSearchFields += "ItemUDF9" + ",";
            narrowSearchValues += ItemUDF9 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF9" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////113////////////////////////////////////////////////////

        if (ItemUDF10 != undefined && ItemUDF10.length > 0) {
            narrowSearchFields += "ItemUDF10" + ",";
            narrowSearchValues += ItemUDF10 + "@@";
        }
        else {
            narrowSearchFields += "ItemUDF10" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////114////////////////////////////////////////////////////

        if (ToolTechUDF1 != undefined && ToolTechUDF1.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolTechUDF1" + ",";
            narrowSearchValues += ToolTechUDF1 + "@@";
        }
        else {
            narrowSearchFields += "ToolTechUDF1" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////115////////////////////////////////////////////////////

        if (ToolTechUDF2 != undefined && ToolTechUDF2.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolTechUDF2" + ",";
            narrowSearchValues += ToolTechUDF2 + "@@";
        }
        else {
            narrowSearchFields += "ToolTechUDF2" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////116////////////////////////////////////////////////////

        if (ToolTechUDF3 != undefined && ToolTechUDF3.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolTechUDF3" + ",";
            narrowSearchValues += ToolTechUDF3 + "@@";
        }
        else {
            narrowSearchFields += "ToolTechUDF3" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////117////////////////////////////////////////////////////

        if (ToolTechUDF4 != undefined && ToolTechUDF4.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolTechUDF4" + ",";
            narrowSearchValues += ToolTechUDF4 + "@@";
        }
        else {
            narrowSearchFields += "ToolTechUDF4" + ",";
            narrowSearchValues += "@@";
        }

        /////////////////////////////////////////118////////////////////////////////////////////////////

        if (ToolTechUDF5 != undefined && ToolTechUDF5.length > 0) {
            //narrowSearchItem += "[###]UDF1#" + UserUDF1NarrowValues;
            narrowSearchFields += "ToolTechUDF5" + ",";
            narrowSearchValues += ToolTechUDF5 + "@@";
        }
        else {
            narrowSearchFields += "ToolTechUDF5" + ",";
            narrowSearchValues += "@@";
        }





        var searchtext = '';
        if (typeof ($("#ToolModel_filter").val()) != "undefined" &&  $("#ToolModel_filter").val() != '')
            searchtext = $("#ToolModel_filter").val().replace(/'/g, "''").replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;").replace(/"/g, "&quot;");
        narrowSearch = narrowSearchFields + "[###]" + narrowSearchValues + "[###]" + searchtext;

        if (narrowSearch.length > 10)
            NarrowSearchInGridToolModel(narrowSearch);
        else if (UserCreatedNarroValues == undefined || UserCreatedNarroValues.length == 0 ||
             UserUpdatedNarroValues == undefined || UserUpdatedNarroValues.length == 0)
            NarrowSearchInGridToolModel(narrowSearch);
        // }

    }


    function NarrowSearchInGridToolModel(searchstr) {
        FilterStringGlobalUse = searchstr;
        $('#tblToolsInModel').dataTable().fnFilter(searchstr, null, null, null)
    }

    function CostNarroSearch(CostDDLObject) {
        //oTable.fnFilter($(CostDDLObject).val(),null,null,null);
        if ($(CostDDLObject).val() != "0_-1") {
            ToolCostValue = $(CostDDLObject).val();
            _NarrowSearchSave.objSearch.ToolsCost = ToolCostValue;
            DoNarrowSearchTool();
        }
        else {
            ToolCostValue = '';
            _NarrowSearchSave.objSearch.ToolsCost = ToolCostValue;
            DoNarrowSearchTool();
        }
    }


</script>

